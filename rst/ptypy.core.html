
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ptypy.core package &#8212; ptypy 0.5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/header.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/ptypyicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ptypy.engines package" href="ptypy.engines.html" />
    <link rel="prev" title="ptypy package" href="ptypy.html" />
<link href='http://fonts.googleapis.com/css?family=PT+Sans|Ubuntu|Cuprum' rel='stylesheet' type='text/css'>

  </head><body>



<div class="pageheader">
  <ul>
    <li><a href="http://ptycho.github.io/ptypy">Home</a></li>
    <li><a href="http://www.github.com/ptycho/ptypy">Github</a></li>
    <li><a href="../content.html">Docs</a></li>
    <!-- <li><a href="develop.html">Extend/Develop</a></li> -->
  </ul>
  <div>
    <a href="../index.html"><img src="../_static/logo_60px.png" alt="SPHINX" /></a>

    <h0 style="padding-bottom:40px">Ptychography for Python</h0>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ptypy.engines.html" title="ptypy.engines package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ptypy.html" title="ptypy package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../content.html">ptypy 0.5.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ptypy.html" accesskey="U">ptypy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ptypy.core package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ptypy-core-package">
<h1>ptypy.core package<a class="headerlink" href="#ptypy-core-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-ptypy.core.classes">
<span id="ptypy-core-classes-module"></span><h2>ptypy.core.classes module<a class="headerlink" href="#module-ptypy.core.classes" title="Permalink to this headline">¶</a></h2>
<p>Container management.</p>
<p>This module defines flexible containers for the various quantities needed
for ptychographic reconstructions.</p>
<dl class="simple">
<dt><strong>Container class</strong></dt><dd><p>A high-level container that keeps track of sub-containers (Storage)
and Views onto them. A container can copy itself to produce a buffer
needed for calculations. Some basic Mathematical operations are
implemented at this level as in place operations.
In general, operations on arrays should be done using the Views, which
simply return numpy arrays.</p>
</dd>
<dt><strong>Storage class</strong></dt><dd><p>The sub-container, wrapping a numpy array buffer. A Storage defines a
system of coordinate (for now only a scaled translation of the pixel
coordinates, but more complicated affine transformation could be
implemented if needed). The sub-class DynamicStorage can adapt the size
of its buffer (cropping and/or padding) depending on the Views.</p>
</dd>
<dt><strong>View class</strong></dt><dd><p>A low-weight class that contains all information to access a 2D piece
of a Storage within a Container. The basic idea is that the View
access is controlled by a physical position and its frame, such that
one is not bothered by memory/array addresses when accessing data.</p>
</dd>
</dl>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.classes.Base">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.classes.</span></span><span class="sig-name descname"><span class="pre">Base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BeOwner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Base" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Ptypy Base class to support some kind of hierarchy,
conversion to and from dictionaries as well as a ‘cross-node’ ID
management of python objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> (<em>Other subclass of Base</em><em> or </em><a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><em>Base</em></a>) – Owner gives IDs to other ptypy objects that refer to it
as owner. Owner also keeps a reference to these objects in
its internal _pool where objects are key-sorted according
to their ID prefix</p></li>
<li><p><strong>ID</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>int</em>) – </p></li>
<li><p><strong>BeOwner</strong> (<em>bool</em>) – Set to <cite>False</cite> if this instance is not intended to own other
ptypy objects.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Base.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.classes.Base.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Base.calc_mem_usage">
<span class="sig-name descname"><span class="pre">calc_mem_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Base.calc_mem_usage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Base.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.classes.Base.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Base.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.classes.Base.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.classes.Container">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.classes.</span></span><span class="sig-name descname"><span class="pre">Container</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'complex'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cloned'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.classes.Base</span></code></a></p>
<p>High-level container class.</p>
<p>Container can be seen as a “super-numpy-array” which can contain multiple
sub-containers of type <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>, potentially of different shape,
along with all <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> instances that act on these Storages to extract
data from the internal data buffer <a class="reference internal" href="#ptypy.core.classes.Storage.data" title="ptypy.core.classes.Storage.data"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Storage.data</span></code></a>.</p>
<p>Typically there will be five such base containers in a <a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Ptycho</span></code></a>
reconstruction instance:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>Cprobe</cite>, Storages for the illumination, i.e. <strong>probe</strong>,</p></li>
<li><p><cite>Cobj</cite>, Storages for the sample transmission, i.e. <strong>object</strong>,</p></li>
<li><p><cite>Cexit</cite>, Storages for the <strong>exit waves</strong>,</p></li>
<li><p><cite>Cdiff</cite>, Storages for <strong>diffraction data</strong>, usually one per scan,</p></li>
<li><p><cite>Cmask</cite>, Storages for <strong>masks</strong> (and weights), usually one per scan,</p></li>
</ul>
</div></blockquote>
<p>A container can conveniently duplicate all its internal <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>
instances into a new Container using <a class="reference internal" href="#ptypy.core.classes.Container.copy" title="ptypy.core.classes.Container.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code></a>. This feature is
intensively used in the reconstruction engines where buffer copies
are needed to temporarily store results. These copies are referred
by the “original” container through the property <a class="reference internal" href="#ptypy.core.classes.Container.copies" title="ptypy.core.classes.Container.copies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copies()</span></code></a> and
a copy refers to its original through the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">original</span></code>
In order to reduce the number of <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> instances, Container copies
do not hold views and use instead the Views held by the original container</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~Container.original</strong> (<a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><em>Container</em></a>) – If self is copy of a Container, this attribute refers to the original
Container. Otherwise it is None.</p></li>
<li><p><strong>~Container.data_type</strong> (<em>str</em>) – Either “single” or “double”</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ID</strong> (<em>str</em><em> or </em><em>int</em>) – A unique ID, managed by the parent.</p></li>
<li><p><strong>owner</strong> (<a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><em>Base</em></a>) – A possible subclass of <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Base</span></code></a> that holds this Container.</p></li>
<li><p><strong>data_type</strong> (<em>str</em><em> or </em><em>numpy.dtype</em>) – data type - either a numpy.dtype object or ‘complex’ or
‘real’ (precision is taken from ptycho.FType or ptycho.CType)</p></li>
<li><p><strong>data_dims</strong> (<em>int</em>) – dimension of data, can be 2 or 3</p></li>
<li><p><strong>distribution</strong> (<em>str</em>) – Indicates if the data is “cloned” in all MPI processes or “scattered”</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.classes.Container.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.S">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">S</span></span><a class="headerlink" href="#ptypy.core.classes.Container.S" title="Permalink to this definition">¶</a></dt>
<dd><p>A property that returns the internal dictionary of all
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> instances in this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.Sp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sp</span></span><a class="headerlink" href="#ptypy.core.classes.Container.Sp" title="Permalink to this definition">¶</a></dt>
<dd><p>A property that returns the internal dictionary of all
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> instances in this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a> as a <a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Param</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.V">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">V</span></span><a class="headerlink" href="#ptypy.core.classes.Container.V" title="Permalink to this definition">¶</a></dt>
<dd><p>A property that returns the internal dictionary of all
<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> instances in this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.Vp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Vp</span></span><a class="headerlink" href="#ptypy.core.classes.Container.Vp" title="Permalink to this definition">¶</a></dt>
<dd><p>A property that returns the internal dictionary of all
<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> instances in this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a> as a <a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Param</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Access content through view.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>view</strong> (<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><em>View</em></a>) – A valid <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set content given by view.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>view</strong> (<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><em>View</em></a>) – A valid <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> for this object</p></li>
<li><p><strong>newdata</strong> (<em>array_like</em>) – The data to be stored 2D.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.allreduce">
<span class="sig-name descname"><span class="pre">allreduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.allreduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs MPI parallel <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> with a sum as reduction
for all <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> instances held by <em>self</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><em>Container</em></a>) – Input</p></li>
<li><p><strong>op</strong> – Reduction operation. If <code class="docutils literal notranslate"><span class="pre">None</span></code> uses sum.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parallel.allreduce" title="ptypy.utils.parallel.allreduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ptypy.utils.parallel.allreduce</span></code></a>, <a class="reference internal" href="#ptypy.core.classes.Storage.allreduce" title="ptypy.core.classes.Storage.allreduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Storage.allreduce</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce / delete all data in attached storages</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.copies">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">copies</span></span><a class="headerlink" href="#ptypy.core.classes.Container.copies" title="Permalink to this definition">¶</a></dt>
<dd><p>Property that returns list of all copies of this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a> matching self.</p>
<p>The copy does not manage views.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fill</strong> (<em>scalar</em><em> or </em><em>None</em>) – If None (default), copy content. If scalar, initializes
to this value</p></li>
<li><p><strong>dtype</strong> (<em>valid data type</em><em> or </em><em>None</em>) – If None, the copy will have the same data type as the
original, is specified the returned instance will contain
empty buffers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.delete_copy">
<span class="sig-name descname"><span class="pre">delete_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">copy_IDs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.delete_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a copy or all copies of this container from owner instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>copy_IDs</strong> (<em>str</em>) – ID of copy to be deleted. If None, deletes <em>all</em> copies</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#ptypy.core.classes.Container.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Property that returns numpy dtype of all internal data buffers</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill all storages with scalar value <cite>fill</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.formatted_report">
<span class="sig-name descname"><span class="pre">formatted_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">:</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.formatted_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns formatted string and a dict with the respective information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_format</strong> (<em>list</em>) – <p>List of (<em>item</em>, <em>length</em>) pairs where item is name of the info
to be listed in the report and length is the column width.
The following items are allowed:</p>
<ul>
<li><p><em>memory</em>, for memory usage of the storages and total use</p></li>
<li><p><em>shape</em>, for shape of internal storages</p></li>
<li><p><em>dimensions</em>, is <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">\*</span> <span class="pre">psize</span></code></p></li>
<li><p><em>psize</em>, for pixel size of storages</p></li>
<li><p><em>views</em>, for number of views in each storage</p></li>
</ul>
</p></li>
<li><p><strong>offset</strong> (<em>int</em><em>, </em><em>optional</em>) – First column width</p></li>
<li><p><strong>separator</strong> (<em>str</em><em>, </em><em>optional</em>) – Column separator</p></li>
<li><p><strong>align</strong> (<em>str</em><em>, </em><em>optional</em>) – Column alignment, either <code class="docutils literal notranslate"><span class="pre">'right'</span></code> or <code class="docutils literal notranslate"><span class="pre">'left'</span></code></p></li>
<li><p><strong>include_header</strong> (<em>bool</em>) – Include a header if True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fstring</strong> (<em>str</em>) – Formatted string</p></li>
<li><p><strong>dct</strong> (<em>dict</em>) – Dictionary containing with the respective info to the keys
in <cite>table_format</cite></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#ptypy.core.classes.Storage.formatted_report" title="ptypy.core.classes.Storage.formatted_report"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Storage.formatted_report</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the container’s total buffer space in bytes and storage info.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>space</strong> (<em>int</em>) – Accumulated memory usage of all data buffers in this Container</p></li>
<li><p><strong>fstring</strong> (<em>str</em>) – Formatted string</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>May get <strong>deprecated</strong> in future. Use formatted_report instead.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#ptypy.core.classes.Container.report" title="ptypy.core.classes.Container.report"><code class="xref py py-obj docutils literal notranslate"><span class="pre">report</span></code></a>, <a class="reference internal" href="#ptypy.core.classes.Container.formatted_report" title="ptypy.core.classes.Container.formatted_report"><code class="xref py py-obj docutils literal notranslate"><span class="pre">formatted_report</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.nbytes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nbytes</span></span><a class="headerlink" href="#ptypy.core.classes.Container.nbytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return total number of bytes used by numpy array buffers
in this container. This is not the actual size in memory of the
whole container, as it does not include the views or dictionary
overhead.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.ndim">
<span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#ptypy.core.classes.Container.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Default data dimensionality for Views and Storages.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.new_storage">
<span class="sig-name descname"><span class="pre">new_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.new_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and register a storage object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ID</strong> (<em>str</em>) – An ID for the storage. If None, a new ID is created. An
error will be raised if the ID already exists.</p></li>
<li><p><strong>kwargs</strong> – Arguments for new storage creation. See doc for
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.classes.Container.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.classes.Container.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.reformat">
<span class="sig-name descname"><span class="pre">reformat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">also_in_copies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.reformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reformats all storages in this container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>also_in_copies</strong> (<em>bool</em>) – If True, also reformat associated copies of this container</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a formatted report string on all storages in this container.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#ptypy.core.classes.Container.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return total number of pixels in this container.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.storages">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storages</span></span><a class="headerlink" href="#ptypy.core.classes.Container.storages" title="Permalink to this definition">¶</a></dt>
<dd><p>A property that returns the internal dictionary of all
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> instances in this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.views">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">views</span></span><a class="headerlink" href="#ptypy.core.classes.Container.views" title="Permalink to this definition">¶</a></dt>
<dd><p>A property that returns the internal dictionary of all
<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> instances in this <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Container.views_in_storage">
<span class="sig-name descname"><span class="pre">views_in_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Container.views_in_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of views on <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> <cite>s</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><em>Storage</em></a>) – The storage to look for.</p></li>
<li><p><strong>active_only</strong> (<em>True</em><em> or </em><em>False</em>) – If True (default), return only active views.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.classes.POD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.classes.</span></span><span class="sig-name descname"><span class="pre">POD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">views</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.POD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.classes.Base</span></code></a></p>
<p>POD : Ptychographic Object Descriptor</p>
<p>A POD brings together probe view, object view and diff view. It also
gives access to “exit”, a (coherent) exit wave, and to propagation
objects to go from exit to diff space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ptycho</strong> (<a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho"><em>Ptycho</em></a>) – The instance of Ptycho associated with this pod.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#ptypy.core.manager.ScanModel" title="ptypy.core.manager.ScanModel"><em>ScanModel</em></a>) – The instance of ScanModel (or it subclasses) which describes
this pod.</p></li>
<li><p><strong>ID</strong> (<em>str</em><em> or </em><em>int</em>) – The pod ID, If None it is managed by the ptycho.</p></li>
<li><p><strong>views</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – The views. See <a class="reference internal" href="#ptypy.core.classes.POD.DEFAULT_VIEWS" title="ptypy.core.classes.POD.DEFAULT_VIEWS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_VIEWS</span></code></a>.</p></li>
<li><p><strong>geometry</strong> (<a class="reference internal" href="#ptypy.core.geometry.Geo" title="ptypy.core.geometry.Geo"><em>Geo</em></a>) – Geometry class instance and attached propagator</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.DEFAULT_VIEWS">
<span class="sig-name descname"><span class="pre">DEFAULT_VIEWS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'diff':</span> <span class="pre">None,</span> <span class="pre">'exit':</span> <span class="pre">None,</span> <span class="pre">'mask':</span> <span class="pre">None,</span> <span class="pre">'obj':</span> <span class="pre">None,</span> <span class="pre">'probe':</span> <span class="pre">None}</span></em><a class="headerlink" href="#ptypy.core.classes.POD.DEFAULT_VIEWS" title="Permalink to this definition">¶</a></dt>
<dd><p>Default set of <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a>s used by a POD</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.classes.POD.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.active">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">active</span></span><a class="headerlink" href="#ptypy.core.classes.POD.active" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that describes whether this pod is active or not.
Equivalent to <code class="docutils literal notranslate"><span class="pre">self.di_view.active</span></code></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.bw">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bw</span></span><a class="headerlink" href="#ptypy.core.classes.POD.bw" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that returns backward propagator of attached
Geometry instance. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.geometry.propagator.bw</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.diff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diff</span></span><a class="headerlink" href="#ptypy.core.classes.POD.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that links to slice of diffraction
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.di_view.data</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.downsample">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">downsample</span></span><a class="headerlink" href="#ptypy.core.classes.POD.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Convencience property that returns downsample function of attached
Geometry instance. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.geometry.downsample</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.exit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exit</span></span><a class="headerlink" href="#ptypy.core.classes.POD.exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that links to slice of exit wave
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.pr_view.data</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.fw">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fw</span></span><a class="headerlink" href="#ptypy.core.classes.POD.fw" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that returns forward propagator of attached
Geometry instance. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.geometry.propagator.fw</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.geometry">
<span class="sig-name descname"><span class="pre">geometry</span></span><a class="headerlink" href="#ptypy.core.classes.POD.geometry" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#ptypy.core.geometry.Geo" title="ptypy.core.geometry.Geo"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Geo</span></code></a> instance with propagators</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mask</span></span><a class="headerlink" href="#ptypy.core.classes.POD.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that links to slice of masking
<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.ma_view.data</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.classes.POD.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.object">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">object</span></span><a class="headerlink" href="#ptypy.core.classes.POD.object" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that links to slice of object <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>.
Usually equivalent to <code class="docutils literal notranslate"><span class="pre">self.ob_view.data</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.classes.POD.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.pr_view">
<span class="sig-name descname"><span class="pre">pr_view</span></span><a class="headerlink" href="#ptypy.core.classes.POD.pr_view" title="Permalink to this definition">¶</a></dt>
<dd><p>A reference to the (pr)obe-view. (ob)ject-, (ma)sk- and
(di)ff-view are accessible in the same manner (<code class="docutils literal notranslate"><span class="pre">self.xx_view</span></code>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.probe">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">probe</span></span><a class="headerlink" href="#ptypy.core.classes.POD.probe" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property that links to slice of probe <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>.
Equivalent to <code class="docutils literal notranslate"><span class="pre">self.pr_view.data</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.POD.upsample">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">upsample</span></span><a class="headerlink" href="#ptypy.core.classes.POD.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Convencience property that returns upsample function of attached
Geometry instance. Equivalent to <code class="docutils literal notranslate"><span class="pre">self.geometry.upsample</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.classes.</span></span><span class="sig-name descname"><span class="pre">Storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layermap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.classes.Base</span></code></a></p>
<p>Inner container handling access to data arrays.</p>
<p>This class essentially manages access to an internal numpy array
buffer called <a class="reference internal" href="#ptypy.core.classes.Storage.data" title="ptypy.core.classes.Storage.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></a></p>
<ul class="simple">
<li><p>It returns a view to coordinates given (slicing)</p></li>
<li><p>It contains a physical coordinate grid</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container</strong> (<a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><em>Container</em></a>) – The container instance</p></li>
<li><p><strong>ID</strong> (<em>None</em><em>, </em><em>str</em><em> or </em><em>int</em>) – A unique ID, managed by the parent, if None ID is generated
by parent.</p></li>
<li><p><strong>data</strong> (<em>ndarray</em><em> or </em><em>None</em>) – A numpy array to use as initial buffer.
<em>Deprecated</em> in v0.3, use fill method instead.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>int</em><em>, or </em><em>None</em>) – The shape of the buffer. If None or int, the dimensionality
is found from the owning Container instance. Otherwise the
dimensionality is <cite>len(shape)-1</cite>.</p></li>
<li><p><strong>fill</strong> (<em>float</em><em> or </em><em>complex</em>) – The default value to fill storage with, will be converted to
data type of owner.</p></li>
<li><p><strong>psize</strong> (<em>float</em><em> or </em><em>(</em><em>ndim</em><em>)</em><em>-tuple of float</em>) – The physical pixel size.</p></li>
<li><p><strong>origin</strong> (<em>(</em><em>ndim</em><em>)</em><em>-tuple of int</em>) – The physical coordinates of the [0,..,0] pixel (upper-left
corner of the storage buffer).</p></li>
<li><p><strong>layermap</strong> (<em>list</em><em> or </em><em>None</em>) – A list (or 1D numpy array) mapping input layer indices
to the internal buffer. This may be useful if the buffer
contains only a portion of a larger data set (as when using
distributed data with MPI). If None, provide direct access.
to the 3d internal data.</p></li>
<li><p><strong>padonly</strong> (<em>bool</em>) – If True, reformat() will enlarge the internal buffer if needed,
but will not shrink it.</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – Number of pixels (voxels) to add as padding around the area defined
by the views.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Storage[v]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The view to internal data buffer corresponding to View or layer <cite>v</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newdata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Storage[v] = newdata</p>
<p>Set internal data buffer to <cite>newdata</cite> for the region of view <cite>v</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><em>View</em></a>) – A View for this storage</p></li>
<li><p><strong>newdata</strong> (<em>ndarray</em>) – Two-dimensional array that fits the view’s shape</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.allreduce">
<span class="sig-name descname"><span class="pre">allreduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.allreduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs MPI parallel <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> with a default sum as
reduction operation for internal data buffer <code class="docutils literal notranslate"><span class="pre">self.data</span></code>.
This method does nothing if the storage is distributed across
nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>op</strong> – Reduction operation. If <code class="docutils literal notranslate"><span class="pre">None</span></code> uses sum.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parallel.allreduce" title="ptypy.utils.parallel.allreduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ptypy.utils.parallel.allreduce</span></code></a>, <a class="reference internal" href="#ptypy.core.classes.Container.allreduce" title="ptypy.core.classes.Container.allreduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Container.allreduce</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.center">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">center</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the position of the origin relative to the upper-left corner
of the storage, in pixel coordinates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this storage object.</p>
<p>Note: the returned copy has the same container as self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ID</strong> (<em>str</em><em> or </em><em>int</em>) – A unique ID, managed by the parent</p></li>
<li><p><strong>fill</strong> (<em>scalar</em><em> or </em><em>None</em>) – If float, set the content to this value. If None, copy the
current content.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Three/four or potentially N-dimensional array as data buffer</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill managed buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fill</strong> (<em>scalar</em><em>, </em><em>numpy array</em><em> or </em><em>None.</em>) – Fill value to use. If fill is a numpy array, it is cast
as self.dtype and self.shape is updated to reflect the
new buffer shape. If fill is None, use default value
(self.fill_value).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.fill_value">
<span class="sig-name descname"><span class="pre">fill_value</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.fill_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Default fill value</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.formatted_report">
<span class="sig-name descname"><span class="pre">formatted_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">:</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.formatted_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns formatted string and a dict with the respective information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_format</strong> (<em>list</em><em>, </em><em>optional</em>) – <p>List of (<em>item</em>,*length*) pairs where item is name of the info
to be listed in the report and length is the column width.
The following items are allowed:</p>
<ul>
<li><p><em>memory</em>, for memory usage of the storages and total use</p></li>
<li><p><em>shape</em>, for shape of internal storages</p></li>
<li><p><em>dimensions</em>, is <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">\*</span> <span class="pre">psize</span></code></p></li>
<li><p><em>psize</em>, for pixel size of storages</p></li>
<li><p><em>views</em>, for number of views in each storage</p></li>
</ul>
</p></li>
<li><p><strong>offset</strong> (<em>int</em><em>, </em><em>optional</em>) – First column width</p></li>
<li><p><strong>separator</strong> (<em>str</em><em>, </em><em>optional</em>) – Column separator.</p></li>
<li><p><strong>align</strong> (<em>str</em><em>, </em><em>optional</em>) – Column alignment, either <code class="docutils literal notranslate"><span class="pre">'right'</span></code> or <code class="docutils literal notranslate"><span class="pre">'left'</span></code>.</p></li>
<li><p><strong>include_header</strong> (<em>bool</em><em>, </em><em>optional</em>) – Include a header if True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fstring</strong> (<em>str</em>) – Formatted string</p></li>
<li><p><strong>dct</strong> (<em>dict</em>) – Dictionary containing with the respective info to the keys
in <cite>table_format</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.get_view_coverage">
<span class="sig-name descname"><span class="pre">get_view_coverage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.get_view_coverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an array in the shape of internal buffer where the value
of each pixel represents the number of views that cover that pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>view coverage in the shape of internal buffer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.grids">
<span class="sig-name descname"><span class="pre">grids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.grids" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>x, y</strong> – grids in the shape of internal buffer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions for <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> access</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.origin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">origin</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the physical position of the upper-left corner of the storage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.psize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psize</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.psize" title="Permalink to this definition">¶</a></dt>
<dd><p>The pixel size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.reformat">
<span class="sig-name descname"><span class="pre">reformat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.reformat" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop or pad if required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newID</strong> (<em>str</em><em> or </em><em>int</em>) – If None (default) act on self. Otherwise create a copy
of self before doing the cropping and padding.</p></li>
<li><p><strong>update</strong> (<em>bool</em>) – If True, updates all Views before reformatting. Not necessarily
needed, if Views have been recently instantiated. Roughly doubles
execution time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s</strong> – returns new Storage instance in same <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a> if
<cite>newId</cite> is not None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage">Storage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.report" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a formatted string giving a report on this storage.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update internal state, including all views on this storage to
ensure consistency with the physical coordinate system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.update_views">
<span class="sig-name descname"><span class="pre">update_views</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.update_views" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the access information for a given view.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> (<a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><em>View</em></a><em> or </em><em>None</em>) – The view object to update. If None, loop through all views.
Apart from that, no check is done, not even whether
the view is actually on self. Use cautiously.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.views">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">views</span></span><a class="headerlink" href="#ptypy.core.classes.Storage.views" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the views that refer to this storage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.Storage.zoom_to_psize">
<span class="sig-name descname"><span class="pre">zoom_to_psize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_psize</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.Storage.zoom_to_psize" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes pixel size and zooms the data buffer along last two axis
accordingly, updates all attached views and reformats if necessary.
<strong>untested!!</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_psize</strong> (<em>scalar</em><em> or </em><em>array_like</em>) – new pixel size</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.classes.View">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.classes.</span></span><span class="sig-name descname"><span class="pre">View</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accessrule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.View" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.classes.Base</span></code></a></p>
<p>A ‘window’ on a Container.</p>
<p>A view stores all the slicing information to extract a 2D piece
of Container.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The final structure of this class is yet up to debate
and the constructor signature may change. Especially since
‘DEFAULT_ACCESSRULE’ is yet so small, its contents could be
incorporated in the constructor call.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>container</strong> (<a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><em>Container</em></a>) – The Container instance this view applies to.</p></li>
<li><p><strong>ID</strong> (<em>str</em><em> or </em><em>int</em>) – ID for this view. Automatically built from ID if None.</p></li>
<li><p><strong>accessrule</strong> (<em>dict</em>) – All the information necessary to access the wanted slice.
Maybe subject to change as code evolve. See keyword arguments
Almost all keys of accessrule will be available as attributes
in the constructed View instance.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>storageID</strong> (<em>str</em>) – ID of storage, If the Storage does not exist
it will be created! (<em>default</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>shape</strong> (<em>int</em><em> or </em><em>tuple of int</em>) – Shape of the view in pixels (<em>default</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>coord</strong> (<em>2-tuple of float</em><em>,</em>) – Physical coordinates <em>(meter)</em> of the center of the view.</p></li>
<li><p><strong>psize</strong> (<em>float</em><em> or </em><em>tuple of float</em>) – Pixel size in <em>(meter)</em> . Required for storage initialization.</p></li>
<li><p><strong>layer</strong> (<em>int</em>) – Index of the third dimension if applicable.
(<em>default</em> is <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><strong>active</strong> (<em>bool</em>) – Whether this view is active (<em>default</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.DEFAULT_ACCESSRULE">
<span class="sig-name descname"><span class="pre">DEFAULT_ACCESSRULE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'active':</span> <span class="pre">True,</span> <span class="pre">'coord':</span> <span class="pre">None,</span> <span class="pre">'layer':</span> <span class="pre">0,</span> <span class="pre">'psize':</span> <span class="pre">1.0,</span> <span class="pre">'shape':</span> <span class="pre">None,</span> <span class="pre">'storageID':</span> <span class="pre">None}</span></em><a class="headerlink" href="#ptypy.core.classes.View.DEFAULT_ACCESSRULE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.classes.View.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.active">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">active</span></span><a class="headerlink" href="#ptypy.core.classes.View.active" title="Permalink to this definition">¶</a></dt>
<dd><p>Active state. If False this view will be ignored when
resizing the data buffer of the associated <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.coord">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coord</span></span><a class="headerlink" href="#ptypy.core.classes.View.coord" title="Permalink to this definition">¶</a></dt>
<dd><p>The View’s physical coordinate (meters)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.classes.View.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.classes.View.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#ptypy.core.classes.View.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The view content in data buffer of associated storage.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.dcoord">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dcoord</span></span><a class="headerlink" href="#ptypy.core.classes.View.dcoord" title="Permalink to this definition">¶</a></dt>
<dd><p>Center coordinate (index) in data buffer.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.dhigh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dhigh</span></span><a class="headerlink" href="#ptypy.core.classes.View.dhigh" title="Permalink to this definition">¶</a></dt>
<dd><p>High side of the View’s data range.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.dlayer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dlayer</span></span><a class="headerlink" href="#ptypy.core.classes.View.dlayer" title="Permalink to this definition">¶</a></dt>
<dd><p>The “layer” i.e. first axis index in Storage data buffer</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.dlow">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dlow</span></span><a class="headerlink" href="#ptypy.core.classes.View.dlow" title="Permalink to this definition">¶</a></dt>
<dd><p>Low side of the View’s data range.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.error">
<span class="sig-name descname"><span class="pre">error</span></span><a class="headerlink" href="#ptypy.core.classes.View.error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.layer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">layer</span></span><a class="headerlink" href="#ptypy.core.classes.View.layer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#ptypy.core.classes.View.ndim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.classes.View.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.classes.View.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.pcoord">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pcoord</span></span><a class="headerlink" href="#ptypy.core.classes.View.pcoord" title="Permalink to this definition">¶</a></dt>
<dd><p>The physical coordinate in pixel space</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.pod">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pod</span></span><a class="headerlink" href="#ptypy.core.classes.View.pod" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns first <a class="reference internal" href="#ptypy.core.classes.POD" title="ptypy.core.classes.POD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">POD</span></code></a> in the <code class="docutils literal notranslate"><span class="pre">self.pods</span></code> dict.
This is a common call in the code and has therefore found
its way here. May return <code class="docutils literal notranslate"><span class="pre">None</span></code> if there is no pod connected.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.pods">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pods</span></span><a class="headerlink" href="#ptypy.core.classes.View.pods" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all <a class="reference internal" href="#ptypy.core.classes.POD" title="ptypy.core.classes.POD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">POD</span></code></a>s still connected to this view as a dict.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.psize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psize</span></span><a class="headerlink" href="#ptypy.core.classes.View.psize" title="Permalink to this definition">¶</a></dt>
<dd><p>Pixel size of the View.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#ptypy.core.classes.View.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Two dimensional shape of View.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.slice">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">slice</span></span><a class="headerlink" href="#ptypy.core.classes.View.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a slice-tuple according to <code class="docutils literal notranslate"><span class="pre">self.layer</span></code>, <code class="docutils literal notranslate"><span class="pre">self.dlow</span></code>
and <code class="docutils literal notranslate"><span class="pre">self.dhigh</span></code>.
Please note, that this may not always makes sense</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.classes.View.sp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sp</span></span><a class="headerlink" href="#ptypy.core.classes.View.sp" title="Permalink to this definition">¶</a></dt>
<dd><p>The subpixel difference (meters) between physical coordinate
and data coordinate.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.storage">
<span class="sig-name descname"><span class="pre">storage</span></span><a class="headerlink" href="#ptypy.core.classes.View.storage" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> instance that this view applies to by default.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.classes.View.storageID">
<span class="sig-name descname"><span class="pre">storageID</span></span><a class="headerlink" href="#ptypy.core.classes.View.storageID" title="Permalink to this definition">¶</a></dt>
<dd><p>The storage ID that this view will be forward to if applied
to a <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ptypy.core.data">
<span id="ptypy-core-data-module"></span><h2>ptypy.core.data module<a class="headerlink" href="#module-ptypy.core.data" title="Permalink to this headline">¶</a></h2>
<p>data - Diffraction data access.</p>
<p>This module defines a PtyScan, a container to hold the experimental
data of a ptychography scan. Instrument-specific reduction routines should
inherit PtyScan to prepare data for the Ptycho Instance in a uniform format.</p>
<p>The experiment specific child class only needs to overwrite 2 functions
of the base class:</p>
<p>For the moment the module contains two main objects:
PtyScan, which holds a single ptychography scan, and DataSource, which
holds a collection of datascans and feeds the data as required.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.data.MoonFlowerScan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.data.</span></span><span class="sig-name descname"><span class="pre">MoonFlowerScan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.MoonFlowerScan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.data.PtyScan" title="ptypy.core.data.PtyScan"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.data.PtyScan</span></code></a></p>
<p>Test PtyScan class producing a romantic ptychographic data set of a moon
illuminating flowers.</p>
<p>Override parent class default:</p>
<p>Parent pars are for the</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.MoonFlowerScan.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'add_poisson_noise':</span> <span class="pre">True,</span> <span class="pre">'auto_center':</span> <span class="pre">None,</span> <span class="pre">'block_wait_count':</span> <span class="pre">0,</span> <span class="pre">'center':</span> <span class="pre">'fftshift',</span> <span class="pre">'chunk_format':</span> <span class="pre">'.chunk%02d',</span> <span class="pre">'density':</span> <span class="pre">0.2,</span> <span class="pre">'dfile':</span> <span class="pre">None,</span> <span class="pre">'distance':</span> <span class="pre">7.19,</span> <span class="pre">'energy':</span> <span class="pre">7.2,</span> <span class="pre">'experimentID':</span> <span class="pre">None,</span> <span class="pre">'label':</span> <span class="pre">None,</span> <span class="pre">'load_parallel':</span> <span class="pre">'data',</span> <span class="pre">'min_frames':</span> <span class="pre">1,</span> <span class="pre">'model':</span> <span class="pre">'round',</span> <span class="pre">'name':</span> <span class="pre">'MoonFlowerScan',</span> <span class="pre">'num_frames':</span> <span class="pre">100,</span> <span class="pre">'orientation':</span> <span class="pre">None,</span> <span class="pre">'photons':</span> <span class="pre">100000000.0,</span> <span class="pre">'positions_theory':</span> <span class="pre">None,</span> <span class="pre">'psf':</span> <span class="pre">0.0,</span> <span class="pre">'psize':</span> <span class="pre">0.000172,</span> <span class="pre">'rebin':</span> <span class="pre">None,</span> <span class="pre">'save':</span> <span class="pre">None,</span> <span class="pre">'shape':</span> <span class="pre">128,</span> <span class="pre">'version':</span> <span class="pre">0.1}</span></em><a class="headerlink" href="#ptypy.core.data.MoonFlowerScan.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.MoonFlowerScan.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.MoonFlowerScan.check" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p>This method checks how many frames the preparation routine may
process, starting from frame <cite>start</cite> at a request of <cite>frames</cite>.</p>
<p>This method is supposed to return the number of accessible frames
for preparation and should determine if data acquisition for this
scan is finished. Its main purpose is to allow for a data
acquisition scheme, where the number of frames is not known
when <a class="reference internal" href="#ptypy.core.data.PtyScan" title="ptypy.core.data.PtyScan"><code class="xref py py-class docutils literal notranslate"><span class="pre">PtyScan</span></code></a> is constructed, i.e. a data stream or an
on-the-fly reconstructions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="xref py py-data docutils literal notranslate"><span class="pre">num_frames</span></code> is set on <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> of the subclass,
this method can be left as it is.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<em>int</em><em> or </em><em>None</em>) – Number of frames requested.</p></li>
<li><p><strong>start</strong> (<em>int</em><em> or </em><em>None</em>) – Scanpoint index to start checking from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frames_accessible</strong> (<em>int</em>) – Number of frames readable.</p></li>
<li><p><strong>end_of_scan</strong> (<em>int or None</em>) – is one of the following,
- 0, end of the scan is not reached
- 1, end of scan will be reached or is
- None, can’t say</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.MoonFlowerScan.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.MoonFlowerScan.load" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p>Loads data according to node specific scanpoint indices that have
been determined by <code class="xref py py-class docutils literal notranslate"><span class="pre">LoadManager</span></code> or otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>raw, positions, weight</strong> – Dictionaries whose keys are the given scan point <cite>indices</cite>
and whose values are the respective frame / position according
to the scan point index. <cite>weight</cite> and <cite>positions</cite> may be empty</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the <em>most</em> important method to change when subclassing
<a class="reference internal" href="#ptypy.core.data.PtyScan" title="ptypy.core.data.PtyScan"><code class="xref py py-class docutils literal notranslate"><span class="pre">PtyScan</span></code></a>. Most often it suffices to override the constructor
and this method to create a subclass suited for a specific
experiment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.MoonFlowerScan.load_positions">
<span class="sig-name descname"><span class="pre">load_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.MoonFlowerScan.load_positions" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></p>
<p>Loads all positions for all diffraction patterns in this scan.
The positions loaded here will be available by all processes
through the attribute <code class="docutils literal notranslate"><span class="pre">self.positions</span></code>. If you specify position
on a per frame basis in <a class="reference internal" href="#ptypy.core.data.MoonFlowerScan.load" title="ptypy.core.data.MoonFlowerScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> , this function has no
effect.</p>
<p>If theoretical positions <code class="xref py py-data docutils literal notranslate"><span class="pre">positions_theory</span></code> are
provided in the initial parameter set <a class="reference internal" href="#ptypy.core.data.MoonFlowerScan.DEFAULT" title="ptypy.core.data.MoonFlowerScan.DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT</span></code></a>,
specifying positions here has NO effect and will be ignored.</p>
<p>The purpose of this function is to avoid reloading and parallel
reads on files that may require intense parsing to retrieve the
information, e.g. long SPEC log files. If parallel reads or
log file parsing for each set of frames is not a time critical
issue of the subclass, reimplementing this function can be ignored
and it is recommended to only reimplement the <a class="reference internal" href="#ptypy.core.data.MoonFlowerScan.load" title="ptypy.core.data.MoonFlowerScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>
method.</p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>positions</strong> – A (N,2)-array where <em>N</em> is the number of positions.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that this method sets attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_frames</span></code>
in the following manner.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">==</span> <span class="pre">None</span></code> : <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">=</span> <span class="pre">N</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">&lt;</span> <span class="pre">N</span></code> , no effect.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">&gt;</span> <span class="pre">N</span></code> : <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">=</span> <span class="pre">N</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.MoonFlowerScan.load_weight">
<span class="sig-name descname"><span class="pre">load_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.MoonFlowerScan.load_weight" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></p>
<p>Loads a common (2d)-weight for all diffraction patterns. The weight
loaded here will be available by all processes through the
attribute <code class="docutils literal notranslate"><span class="pre">self.weight2d</span></code>. If a <em>per-frame-weight</em> is specified
in <a class="reference internal" href="#ptypy.core.data.MoonFlowerScan.load" title="ptypy.core.data.MoonFlowerScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> , this function has no effect.</p>
<p>The purpose of this function is to avoid reloading and parallel
reads. If that is not critical to the implementation,
reimplementing this function in a subclass can be ignored.</p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>weight2d</strong> – A two-dimensional array with a shape compatible to the raw
diffraction data frames</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, weights will be converted to a mask,
<code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">=</span> <span class="pre">weight2d</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> for use in reconstruction algorithms.
It is planned to use a general weight instead of a mask in future
releases.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ptypy.core.data.PTYD">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.data.</span></span><span class="sig-name descname"><span class="pre">PTYD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'chunks':</span> <span class="pre">{},</span> <span class="pre">'info':</span> <span class="pre">{},</span> <span class="pre">'meta':</span> <span class="pre">{}}</span></em><a class="headerlink" href="#ptypy.core.data.PTYD" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic Structure of a .ptyd datafile</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.data.</span></span><span class="sig-name descname"><span class="pre">PtyScan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>PtyScan: A single ptychography scan, created on the fly or read from file.</p>
<p><em>BASECLASS</em></p>
<dl class="simple">
<dt>Objectives:</dt><dd><ul class="simple">
<li><p>Stand alone functionality</p></li>
<li><p>Can produce .ptyd data formats</p></li>
<li><p>Child instances should be able to prepare from raw data</p></li>
<li><p>On-the-fly support in form of chunked data.</p></li>
<li><p>mpi capable, child classes should not worry about mpi</p></li>
</ul>
</dd>
</dl>
<p>Default data parameters. See <code class="xref py py-data docutils literal notranslate"><span class="pre">scan.data</span></code></p>
<p>Class creation with minimum set of parameters, see <a class="reference internal" href="#ptypy.core.data.PtyScan.DEFAULT" title="ptypy.core.data.PtyScan.DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">PtyScan.DEFAULT</span></code></a>
Please note that class creation is not meant to load data.</p>
<p>Call <a class="reference internal" href="#ptypy.core.data.PtyScan.initialize" title="ptypy.core.data.PtyScan.initialize"><code class="xref py py-data docutils literal notranslate"><span class="pre">initialize</span></code></a> to begin loading and data file creation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.CODES">
<span class="sig-name descname"><span class="pre">CODES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'msg1':</span> <span class="pre">'Scan</span> <span class="pre">unfinished.</span> <span class="pre">More</span> <span class="pre">frames</span> <span class="pre">available</span> <span class="pre">after</span> <span class="pre">a</span> <span class="pre">pause',</span> <span class="pre">'msgEOS':</span> <span class="pre">'End</span> <span class="pre">of</span> <span class="pre">scan</span> <span class="pre">reached'}</span></em><a class="headerlink" href="#ptypy.core.data.PtyScan.CODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'add_poisson_noise':</span> <span class="pre">False,</span> <span class="pre">'auto_center':</span> <span class="pre">None,</span> <span class="pre">'center':</span> <span class="pre">'fftshift',</span> <span class="pre">'chunk_format':</span> <span class="pre">'.chunk%02d',</span> <span class="pre">'dfile':</span> <span class="pre">None,</span> <span class="pre">'distance':</span> <span class="pre">7.19,</span> <span class="pre">'energy':</span> <span class="pre">7.2,</span> <span class="pre">'experimentID':</span> <span class="pre">None,</span> <span class="pre">'label':</span> <span class="pre">None,</span> <span class="pre">'load_parallel':</span> <span class="pre">'data',</span> <span class="pre">'min_frames':</span> <span class="pre">1,</span> <span class="pre">'name':</span> <span class="pre">'PtyScan',</span> <span class="pre">'num_frames':</span> <span class="pre">None,</span> <span class="pre">'orientation':</span> <span class="pre">None,</span> <span class="pre">'positions_theory':</span> <span class="pre">None,</span> <span class="pre">'psize':</span> <span class="pre">0.000172,</span> <span class="pre">'rebin':</span> <span class="pre">None,</span> <span class="pre">'save':</span> <span class="pre">None,</span> <span class="pre">'shape':</span> <span class="pre">256,</span> <span class="pre">'version':</span> <span class="pre">0.1}</span></em><a class="headerlink" href="#ptypy.core.data.PtyScan.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.EOS">
<span class="sig-name descname"><span class="pre">EOS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'msgEOS'</span></em><a class="headerlink" href="#ptypy.core.data.PtyScan.EOS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.METAKEYS">
<span class="sig-name descname"><span class="pre">METAKEYS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['version',</span> <span class="pre">'num_frames',</span> <span class="pre">'label',</span> <span class="pre">'shape',</span> <span class="pre">'psize',</span> <span class="pre">'energy',</span> <span class="pre">'center',</span> <span class="pre">'distance']</span></em><a class="headerlink" href="#ptypy.core.data.PtyScan.METAKEYS" title="Permalink to this definition">¶</a></dt>
<dd><p>Keys to store in meta param</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.WAIT">
<span class="sig-name descname"><span class="pre">WAIT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'msg1'</span></em><a class="headerlink" href="#ptypy.core.data.PtyScan.WAIT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.abort">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">abort</span></span><a class="headerlink" href="#ptypy.core.data.PtyScan.abort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.auto">
<span class="sig-name descname"><span class="pre">auto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.auto" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated calls to this function will process the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>int</em>) – Number of frames to process.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>one of the following</dt><dd><ul class="simple">
<li><p>WAIT, if scan’s end is not reached,
but no data could be prepared yet</p></li>
<li><p>EOS, if scan’s end is reached</p></li>
<li><p>a data package otherwise</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.check" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p>This method checks how many frames the preparation routine may
process, starting from frame <cite>start</cite> at a request of <cite>frames</cite>.</p>
<p>This method is supposed to return the number of accessible frames
for preparation and should determine if data acquisition for this
scan is finished. Its main purpose is to allow for a data
acquisition scheme, where the number of frames is not known
when <a class="reference internal" href="#ptypy.core.data.PtyScan" title="ptypy.core.data.PtyScan"><code class="xref py py-class docutils literal notranslate"><span class="pre">PtyScan</span></code></a> is constructed, i.e. a data stream or an
on-the-fly reconstructions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <a class="reference internal" href="#ptypy.core.data.PtyScan.num_frames" title="ptypy.core.data.PtyScan.num_frames"><code class="xref py py-data docutils literal notranslate"><span class="pre">num_frames</span></code></a> is set on <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> of the subclass,
this method can be left as it is.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<em>int</em><em> or </em><em>None</em>) – Number of frames requested.</p></li>
<li><p><strong>start</strong> (<em>int</em><em> or </em><em>None</em>) – Scanpoint index to start checking from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frames_accessible</strong> (<em>int</em>) – Number of frames readable.</p></li>
<li><p><strong>end_of_scan</strong> (<em>int or None</em>) – is one of the following,
- 0, end of the scan is not reached
- 1, end of scan will be reached or is
- None, can’t say</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.correct">
<span class="sig-name descname"><span class="pre">correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.correct" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p>Place holder for dark and flatfield correction. If <a class="reference internal" href="#ptypy.core.data.PtyScan.load" title="ptypy.core.data.PtyScan.load"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">load</span></code></a>
already provides data in the form of photon counts, and no frame
specific weight is needed, this method may be left as it is.</p>
<p>May get <em>merged</em> with <a class="reference internal" href="#ptypy.core.data.PtyScan.load" title="ptypy.core.data.PtyScan.load"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">load</span></code></a> in future.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>data, weights</strong> – Flat and dark-corrected data dictionaries. These dictionaries
must have the same keys as the input <cite>raw</cite> and contain
corrected frames (<cite>data</cite>) and statistical weights (<cite>weights</cite>)
which are zero for invalid or masked pixel other the number
of detector counts that correspond to one photon count</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.end_of_scan">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">end_of_scan</span></span><a class="headerlink" href="#ptypy.core.data.PtyScan.end_of_scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.frames_accessible">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">frames_accessible</span></span><a class="headerlink" href="#ptypy.core.data.PtyScan.frames_accessible" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.get_data_chunk">
<span class="sig-name descname"><span class="pre">get_data_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunksize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.get_data_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>This function prepares a container that is compatible to data package.</p>
<p>This function is called from the auto() function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.info">
<span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#ptypy.core.data.PtyScan.info" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Param</span></code> container that stores all input parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Begins the Data preparation and intended as the first method
that does read-write access on (large) data. Does the following:</p>
<ul class="simple">
<li><p>Creates a *.ptyd data file at location specified by
<code class="xref py py-data docutils literal notranslate"><span class="pre">dfile</span></code> (master node only)</p></li>
<li><p>Calls <a class="reference internal" href="#ptypy.core.data.PtyScan.load_weight" title="ptypy.core.data.PtyScan.load_weight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_weight()</span></code></a>, <a class="reference internal" href="#ptypy.core.data.PtyScan.load_positions" title="ptypy.core.data.PtyScan.load_positions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_positions()</span></code></a>
<a class="reference internal" href="#ptypy.core.data.PtyScan.load_common" title="ptypy.core.data.PtyScan.load_common"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_common()</span></code></a> (master node only for
<code class="docutils literal notranslate"><span class="pre">load_parallel==None</span></code> or <code class="docutils literal notranslate"><span class="pre">load_parallel=='data'</span></code>)</p></li>
<li><p>Sets <a class="reference internal" href="#ptypy.core.data.PtyScan.num_frames" title="ptypy.core.data.PtyScan.num_frames"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_frames</span></code></a> if needed</p></li>
<li><p>Calls <a class="reference internal" href="#ptypy.core.data.PtyScan.post_initialize" title="ptypy.core.data.PtyScan.post_initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">post_initialize()</span></code></a></p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.load" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p>Loads data according to node specific scanpoint indices that have
been determined by <code class="xref py py-class docutils literal notranslate"><span class="pre">LoadManager</span></code> or otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>raw, positions, weight</strong> – Dictionaries whose keys are the given scan point <cite>indices</cite>
and whose values are the respective frame / position according
to the scan point index. <cite>weight</cite> and <cite>positions</cite> may be empty</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the <em>most</em> important method to change when subclassing
<a class="reference internal" href="#ptypy.core.data.PtyScan" title="ptypy.core.data.PtyScan"><code class="xref py py-class docutils literal notranslate"><span class="pre">PtyScan</span></code></a>. Most often it suffices to override the constructor
and this method to create a subclass suited for a specific
experiment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.load_common">
<span class="sig-name descname"><span class="pre">load_common</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.load_common" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <a class="reference internal" href="#ptypy.core.data.PtyScan.initialize" title="ptypy.core.data.PtyScan.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a></p>
<p>Loads anything and stores that in a dict. This dict will be
available to all processes after <a class="reference internal" href="#ptypy.core.data.PtyScan.initialize" title="ptypy.core.data.PtyScan.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a> through
the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">common</span></code></p>
<p>The purpose of this method is the same as <a class="reference internal" href="#ptypy.core.data.PtyScan.load_weight" title="ptypy.core.data.PtyScan.load_weight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_weight()</span></code></a>
and <a class="reference internal" href="#ptypy.core.data.PtyScan.load_positions" title="ptypy.core.data.PtyScan.load_positions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_positions()</span></code></a> except for that the contents
of <code class="xref py py-attr docutils literal notranslate"><span class="pre">common</span></code> have no built-in effect of the behavior in
the processing other than the user specifies it in py:meth:<cite>load</cite></p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>common</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.load_positions">
<span class="sig-name descname"><span class="pre">load_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.load_positions" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <a class="reference internal" href="#ptypy.core.data.PtyScan.initialize" title="ptypy.core.data.PtyScan.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a></p>
<p>Loads all positions for all diffraction patterns in this scan.
The positions loaded here will be available by all processes
through the attribute <code class="docutils literal notranslate"><span class="pre">self.positions</span></code>. If you specify position
on a per frame basis in <a class="reference internal" href="#ptypy.core.data.PtyScan.load" title="ptypy.core.data.PtyScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> , this function has no
effect.</p>
<p>If theoretical positions <code class="xref py py-data docutils literal notranslate"><span class="pre">positions_theory</span></code> are
provided in the initial parameter set <a class="reference internal" href="#ptypy.core.data.PtyScan.DEFAULT" title="ptypy.core.data.PtyScan.DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT</span></code></a>,
specifying positions here has NO effect and will be ignored.</p>
<p>The purpose of this function is to avoid reloading and parallel
reads on files that may require intense parsing to retrieve the
information, e.g. long SPEC log files. If parallel reads or
log file parsing for each set of frames is not a time critical
issue of the subclass, reimplementing this function can be ignored
and it is recommended to only reimplement the <a class="reference internal" href="#ptypy.core.data.PtyScan.load" title="ptypy.core.data.PtyScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>
method.</p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>positions</strong> – A (N,2)-array where <em>N</em> is the number of positions.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that this method sets attribute <a class="reference internal" href="#ptypy.core.data.PtyScan.num_frames" title="ptypy.core.data.PtyScan.num_frames"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_frames</span></code></a>
in the following manner.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">==</span> <span class="pre">None</span></code> : <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">=</span> <span class="pre">N</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">&lt;</span> <span class="pre">N</span></code> , no effect.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">&gt;</span> <span class="pre">N</span></code> : <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">=</span> <span class="pre">N</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.load_weight">
<span class="sig-name descname"><span class="pre">load_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.load_weight" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <a class="reference internal" href="#ptypy.core.data.PtyScan.initialize" title="ptypy.core.data.PtyScan.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a></p>
<p>Loads a common (2d)-weight for all diffraction patterns. The weight
loaded here will be available by all processes through the
attribute <code class="docutils literal notranslate"><span class="pre">self.weight2d</span></code>. If a <em>per-frame-weight</em> is specified
in <a class="reference internal" href="#ptypy.core.data.PtyScan.load" title="ptypy.core.data.PtyScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> , this function has no effect.</p>
<p>The purpose of this function is to avoid reloading and parallel
reads. If that is not critical to the implementation,
reimplementing this function in a subclass can be ignored.</p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>weight2d</strong> – A two-dimensional array with a shape compatible to the raw
diffraction data frames</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, weights will be converted to a mask,
<code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">=</span> <span class="pre">weight2d</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> for use in reconstruction algorithms.
It is planned to use a general weight instead of a mask in future
releases.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.min_frames">
<span class="sig-name descname"><span class="pre">min_frames</span></span><a class="headerlink" href="#ptypy.core.data.PtyScan.min_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum number of frames to prepare / load
with call of <a class="reference internal" href="#ptypy.core.data.PtyScan.auto" title="ptypy.core.data.PtyScan.auto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">auto()</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.num_frames">
<span class="sig-name descname"><span class="pre">num_frames</span></span><a class="headerlink" href="#ptypy.core.data.PtyScan.num_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of frames to prepare / load.
Set by <code class="xref py py-data docutils literal notranslate"><span class="pre">num_frames</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.post_initialize">
<span class="sig-name descname"><span class="pre">post_initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.post_initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Placeholder. Called at the end of <a class="reference internal" href="#ptypy.core.data.PtyScan.initialize" title="ptypy.core.data.PtyScan.initialize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></a> by all
processes.</p>
<p>Use this method to benefit from ‘hard-to-retrieve but now available’
information after initialize.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtyScan.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtyScan.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a report on internal structure.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.data.PtydScan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.data.</span></span><span class="sig-name descname"><span class="pre">PtydScan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtydScan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.data.PtyScan" title="ptypy.core.data.PtyScan"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.data.PtyScan</span></code></a></p>
<p>PtyScan provided by native “ptyd” file format.</p>
<p>PtyScan provided by native “ptyd” file format.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.data.PtydScan.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'add_poisson_noise':</span> <span class="pre">False,</span> <span class="pre">'auto_center':</span> <span class="pre">None,</span> <span class="pre">'center':</span> <span class="pre">'fftshift',</span> <span class="pre">'chunk_format':</span> <span class="pre">'.chunk%02d',</span> <span class="pre">'dfile':</span> <span class="pre">None,</span> <span class="pre">'distance':</span> <span class="pre">7.19,</span> <span class="pre">'energy':</span> <span class="pre">7.2,</span> <span class="pre">'experimentID':</span> <span class="pre">None,</span> <span class="pre">'label':</span> <span class="pre">None,</span> <span class="pre">'load_parallel':</span> <span class="pre">'data',</span> <span class="pre">'min_frames':</span> <span class="pre">1,</span> <span class="pre">'name':</span> <span class="pre">'PtydScan',</span> <span class="pre">'num_frames':</span> <span class="pre">None,</span> <span class="pre">'orientation':</span> <span class="pre">None,</span> <span class="pre">'positions_theory':</span> <span class="pre">None,</span> <span class="pre">'psize':</span> <span class="pre">0.000172,</span> <span class="pre">'rebin':</span> <span class="pre">None,</span> <span class="pre">'save':</span> <span class="pre">None,</span> <span class="pre">'shape':</span> <span class="pre">256,</span> <span class="pre">'source':</span> <span class="pre">'file',</span> <span class="pre">'version':</span> <span class="pre">0.1}</span></em><a class="headerlink" href="#ptypy.core.data.PtydScan.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtydScan.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtydScan.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the check routine for a .ptyd file format.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#ptypy.core.data.PtyScan.check" title="ptypy.core.data.PtyScan.check"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PtyScan.check</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtydScan.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtydScan.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load from ptyd.</p>
<p>Due to possible chunked data, slicing frames is non-trivial.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtydScan.load_positions">
<span class="sig-name descname"><span class="pre">load_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtydScan.load_positions" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></p>
<p>Loads all positions for all diffraction patterns in this scan.
The positions loaded here will be available by all processes
through the attribute <code class="docutils literal notranslate"><span class="pre">self.positions</span></code>. If you specify position
on a per frame basis in <a class="reference internal" href="#ptypy.core.data.PtydScan.load" title="ptypy.core.data.PtydScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> , this function has no
effect.</p>
<p>If theoretical positions <code class="xref py py-data docutils literal notranslate"><span class="pre">positions_theory</span></code> are
provided in the initial parameter set <a class="reference internal" href="#ptypy.core.data.PtydScan.DEFAULT" title="ptypy.core.data.PtydScan.DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT</span></code></a>,
specifying positions here has NO effect and will be ignored.</p>
<p>The purpose of this function is to avoid reloading and parallel
reads on files that may require intense parsing to retrieve the
information, e.g. long SPEC log files. If parallel reads or
log file parsing for each set of frames is not a time critical
issue of the subclass, reimplementing this function can be ignored
and it is recommended to only reimplement the <a class="reference internal" href="#ptypy.core.data.PtydScan.load" title="ptypy.core.data.PtydScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>
method.</p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>positions</strong> – A (N,2)-array where <em>N</em> is the number of positions.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that this method sets attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_frames</span></code>
in the following manner.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">==</span> <span class="pre">None</span></code> : <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">=</span> <span class="pre">N</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">&lt;</span> <span class="pre">N</span></code> , no effect.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">&gt;</span> <span class="pre">N</span></code> : <code class="docutils literal notranslate"><span class="pre">num_frames</span> <span class="pre">=</span> <span class="pre">N</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.data.PtydScan.load_weight">
<span class="sig-name descname"><span class="pre">load_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.data.PtydScan.load_weight" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Override in subclass for custom implementation</strong></p>
<p><em>Called in</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></p>
<p>Loads a common (2d)-weight for all diffraction patterns. The weight
loaded here will be available by all processes through the
attribute <code class="docutils literal notranslate"><span class="pre">self.weight2d</span></code>. If a <em>per-frame-weight</em> is specified
in <a class="reference internal" href="#ptypy.core.data.PtydScan.load" title="ptypy.core.data.PtydScan.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> , this function has no effect.</p>
<p>The purpose of this function is to avoid reloading and parallel
reads. If that is not critical to the implementation,
reimplementing this function in a subclass can be ignored.</p>
<p>If <cite>load_parallel</cite> is set to <cite>all</cite> or common`, this function is
executed by all nodes, otherwise the master node executes this
function and broadcasts the results to other nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>weight2d</strong> – A two-dimensional array with a shape compatible to the raw
diffraction data frames</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, weights will be converted to a mask,
<code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">=</span> <span class="pre">weight2d</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> for use in reconstruction algorithms.
It is planned to use a general weight instead of a mask in future
releases.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-ptypy.core.geometry">
<span id="ptypy-core-geometry-module"></span><h2>ptypy.core.geometry module<a class="headerlink" href="#module-ptypy.core.geometry" title="Permalink to this headline">¶</a></h2>
<p>Geometry manager.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicFarfieldPropagator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.geometry.</span></span><span class="sig-name descname"><span class="pre">BasicFarfieldPropagator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffttype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicFarfieldPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic single step Farfield Propagator.</p>
<p>Includes quadratic phase factors and arbitrary origin in array.</p>
<p>Be aware though, that if the origin is not in the center of the frame,
coordinates are rolled periodically, just like in the conventional fft case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo_pars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a><em> or </em><em>dict</em>) – Parameter dictionary as in <code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT</span></code>.</p></li>
<li><p><strong>ffttype</strong> (<em>str</em><em> or </em><em>tuple</em>) – <p>Type of FFT implementation. One of:</p>
<ul>
<li><p>’fftw’ for pyFFTW</p></li>
<li><p>’numpy’ for numpy.fft.fft2</p></li>
<li><p>’scipy’ for scipy.fft.fft2</p></li>
<li><p>2 or 4-tuple of (forward_fft2(), inverse_fft2(),
[scaling, inverse_scaling])</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicFarfieldPropagator.bw">
<span class="sig-name descname"><span class="pre">bw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicFarfieldPropagator.bw" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes backward propagated wavefront of input wavefront W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicFarfieldPropagator.fw">
<span class="sig-name descname"><span class="pre">fw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicFarfieldPropagator.fw" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes forward propagated wavefront of input wavefront W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicFarfieldPropagator.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicFarfieldPropagator.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update internal p dictionary. Recompute all internal array buffers.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicNearfieldPropagator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.geometry.</span></span><span class="sig-name descname"><span class="pre">BasicNearfieldPropagator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffttype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fftw'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicNearfieldPropagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Basic two step (i.e. two ffts) Nearfield Propagator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo_pars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a><em> or </em><em>dict</em>) – Parameter dictionary as in <code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT</span></code>.</p></li>
<li><p><strong>ffttype</strong> (<em>str</em><em> or </em><em>tuple</em>) – <p>Type of FFT implementation. One of:</p>
<ul>
<li><p>’fftw’ for pyFFTW</p></li>
<li><p>’numpy’ for numpy.fft.fft2</p></li>
<li><p>’scipy’ for scipy.fft.fft2</p></li>
<li><p>2 or 4-tuple of (forward_fft2(),inverse_fft2(),
[scaling,inverse_scaling])</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicNearfieldPropagator.bw">
<span class="sig-name descname"><span class="pre">bw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicNearfieldPropagator.bw" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes backward propagated wavefront of input wavefront W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicNearfieldPropagator.fw">
<span class="sig-name descname"><span class="pre">fw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicNearfieldPropagator.fw" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes forward propagated wavefront of input wavefront W.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.BasicNearfieldPropagator.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.BasicNearfieldPropagator.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update internal p dictionary. Recompute all internal array buffers.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.geometry.</span></span><span class="sig-name descname"><span class="pre">Geo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.Geo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.classes.Base</span></code></a></p>
<p>Hold and keep consistent the information about experimental parameters.</p>
<p>Keeps also reference to the Propagator and updates this reference
when resolution, pixel size, etc. is changed in <cite>Geo</cite>. Reference to
<code class="xref py py-data docutils literal notranslate"><span class="pre">io.paths.recons</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>~Geo.interact</strong> (<em>bool</em><em> (</em><em>True</em><em>)</em>) – If set to True, changes to properties like <a class="reference internal" href="#ptypy.core.geometry.Geo.energy" title="ptypy.core.geometry.Geo.energy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">energy()</span></code></a>,
<a class="reference internal" href="#ptypy.core.geometry.Geo.lam" title="ptypy.core.geometry.Geo.lam"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lam()</span></code></a>, <a class="reference internal" href="#ptypy.core.geometry.Geo.shape" title="ptypy.core.geometry.Geo.shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shape()</span></code></a> or <a class="reference internal" href="#ptypy.core.geometry.Geo.psize" title="ptypy.core.geometry.Geo.psize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">psize()</span></code></a> will cause
a call to <a class="reference internal" href="#ptypy.core.geometry.Geo.update" title="ptypy.core.geometry.Geo.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a>.</p>
</dd>
</dl>
<p>Default geometry parameters. See also <code class="xref py py-data docutils literal notranslate"><span class="pre">scan.geometry</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> (<a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><em>Base</em></a><em> or </em><em>subclass</em>) – Instance of a subclass of <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Base</span></code></a> or None. That is usually
<a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Ptycho</span></code></a> for a Geo instance.</p></li>
<li><p><strong>ID</strong> (<em>str</em><em> or </em><em>int</em>) – Identifier. Use <code class="docutils literal notranslate"><span class="pre">ID=None</span></code> for automatic ID assignment.</p></li>
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – The configuration parameters. See <cite>Geo.DEFAULT</cite>.
Any other kwarg will update internal p dictionary
if the key exists in <cite>Geo.DEFAULT</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'center':</span> <span class="pre">'fftshift',</span> <span class="pre">'distance':</span> <span class="pre">7.19,</span> <span class="pre">'energy':</span> <span class="pre">6.2,</span> <span class="pre">'lam':</span> <span class="pre">None,</span> <span class="pre">'misfit':</span> <span class="pre">0.0,</span> <span class="pre">'origin':</span> <span class="pre">'fftshift',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'psize':</span> <span class="pre">0.000172,</span> <span class="pre">'resolution':</span> <span class="pre">None,</span> <span class="pre">'shape':</span> <span class="pre">256}</span></em><a class="headerlink" href="#ptypy.core.geometry.Geo.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.distance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagation distance in meters (read-only)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.downsample">
<span class="sig-name descname"><span class="pre">downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.Geo.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample the array a (float)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the energy (in keV). If self.interact is True, recompute
dependent quantities accordingly.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.lam">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lam</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.lam" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the wavelength (in meters).</p>
<p>If self.interact is True, recompute dependent quantities accordingly. Changing wavelengths
never changes the image extent (self.sh).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.lz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lz</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.lz" title="Permalink to this definition">¶</a></dt>
<dd><p>Product of wavelength and propagation distance (read-only)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.propagator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">propagator</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.propagator" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagator, created on-the-fly if needed (read-only)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.psize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psize</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.psize" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the pixel size in the propagated plane (in meters).</p>
<p>If self.interact is True, recompute dependent quantities accordingly.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.resolution">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">resolution</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the pixel size in the image plane (in meters).</p>
<p>If self.interact is True, recompute dependent quantities accordingly.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#ptypy.core.geometry.Geo.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the frame dimensions.</p>
<p>If self.interact is True, recompute dependent quantities accordingly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.Geo.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the internal pixel sizes, giving precedence to the sample
pixel size (resolution) if self.psize_is_fixed is True.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.geometry.Geo.upsample">
<span class="sig-name descname"><span class="pre">upsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.geometry.Geo.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Upsample the array c (float or complex).</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ptypy.core.illumination">
<span id="ptypy-core-illumination-module"></span><h2>ptypy.core.illumination module<a class="headerlink" href="#module-ptypy.core.illumination" title="Permalink to this headline">¶</a></h2>
<p>This module generates the probe.</p>
<p>&#64;author: Bjoern Enders</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.illumination.aperture">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.illumination.</span></span><span class="sig-name descname"><span class="pre">aperture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.illumination.aperture" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an aperture in the shape and dtype of <cite>A</cite> according
to x,y-grids <cite>grids</cite>. Keyword Arguments may be any of
(<em>FIXME</em> link to kwargs)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em>) – Model array (at least 2-dimensional) to place aperture on top.</p></li>
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><em>Param</em>) – Parameters, <em>FIXME</em> link to parameters</p></li>
<li><p><strong>grids</strong> (<em>ndarray</em>) – Cartesian coordinate grids, if None, they will be created with
<code class="docutils literal notranslate"><span class="pre">grids</span> <span class="pre">=</span> <span class="pre">u.grids(sh[-2:],</span> <span class="pre">psize=(1.0,</span> <span class="pre">1.0))</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ap</strong> – Aperture array (complex) in shape of A</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.illumination.init_storage">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.illumination.</span></span><span class="sig-name descname"><span class="pre">init_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">storage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.illumination.init_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> <cite>storage</cite> with parameters from <cite>pars</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage</strong> (<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><em>Storage</em></a>) – A <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> instance in the <em>probe</em> container of <a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Ptycho</span></code></a></p></li>
<li><p><strong>pars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – <p>Parameter structure for creating a probe / illumination.
See <code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT</span></code>
Also accepted as argument:</p>
<blockquote>
<div><ul>
<li><p>string giving the filename of a previous reconstruction to
extract storage from.</p></li>
<li><p>string giving the name of an available TEMPLATE</p></li>
<li><p>FIXME: document other string cases.</p></li>
<li><p>numpy array: interpreted as initial illumination.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>energy</strong> (<em>float</em><em>, </em><em>optional</em>) – Energy associated with this storage. If None, tries to retrieve
the energy from the already initialized ptypy network.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ptypy.core.manager">
<span id="ptypy-core-manager-module"></span><h2>ptypy.core.manager module<a class="headerlink" href="#module-ptypy.core.manager" title="Permalink to this headline">¶</a></h2>
<p>Scan management.</p>
<p>The main task of this module is to prepare the data structure for
reconstruction, taking a data feed and connecting individual diffraction
measurements to the other containers. The way this connection is done
as defined by ScanModel and its subclasses. The connections are
described by the POD objects.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockFull">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">BlockFull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.BlockFull" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager._Full</span></code>, <a class="reference internal" href="#ptypy.core.manager.BlockScanModel" title="ptypy.core.manager.BlockScanModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.BlockScanModel</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockFull.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'coherence':</span> <span class="pre">{'energies':</span> <span class="pre">[1.0],</span> <span class="pre">'num_object_modes':</span> <span class="pre">1,</span> <span class="pre">'num_probe_modes':</span> <span class="pre">1,</span> <span class="pre">'object_dispersion':</span> <span class="pre">None,</span> <span class="pre">'probe_dispersion':</span> <span class="pre">None,</span> <span class="pre">'spectrum':</span> <span class="pre">[1.0]},</span> <span class="pre">'illumination':</span> <span class="pre">{},</span> <span class="pre">'name':</span> <span class="pre">'Full',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'resolution':</span> <span class="pre">None,</span> <span class="pre">'sample':</span> <span class="pre">{},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.BlockFull.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockOPRModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">BlockOPRModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.BlockOPRModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager._OPRModel</span></code>, <a class="reference internal" href="#ptypy.core.manager.BlockFull" title="ptypy.core.manager.BlockFull"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.BlockFull</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockOPRModel.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'coherence':</span> <span class="pre">{'energies':</span> <span class="pre">[1.0],</span> <span class="pre">'num_object_modes':</span> <span class="pre">1,</span> <span class="pre">'num_probe_modes':</span> <span class="pre">1,</span> <span class="pre">'object_dispersion':</span> <span class="pre">None,</span> <span class="pre">'probe_dispersion':</span> <span class="pre">None,</span> <span class="pre">'spectrum':</span> <span class="pre">[1.0]},</span> <span class="pre">'illumination':</span> <span class="pre">{},</span> <span class="pre">'name':</span> <span class="pre">'Full',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'resolution':</span> <span class="pre">None,</span> <span class="pre">'sample':</span> <span class="pre">{},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.BlockOPRModel.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockScanModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">BlockScanModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.BlockScanModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.manager.ScanModel" title="ptypy.core.manager.ScanModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.ScanModel</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockScanModel.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'illumination':</span> <span class="pre">{},</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'sample':</span> <span class="pre">{},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.BlockScanModel.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockScanModel.new_data">
<span class="sig-name descname"><span class="pre">new_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.BlockScanModel.new_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Feed data from ptyscan object.
:return: None if no data is available, Diffraction storage otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockVanilla">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">BlockVanilla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.BlockVanilla" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager._Vanilla</span></code>, <a class="reference internal" href="#ptypy.core.manager.BlockScanModel" title="ptypy.core.manager.BlockScanModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.BlockScanModel</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.BlockVanilla.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'illumination':</span> <span class="pre">{'size':</span> <span class="pre">None},</span> <span class="pre">'name':</span> <span class="pre">'Vanilla',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'sample':</span> <span class="pre">{'fill':</span> <span class="pre">1},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.BlockVanilla.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.Bragg3dModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">Bragg3dModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.Bragg3dModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.manager.Vanilla" title="ptypy.core.manager.Vanilla"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.Vanilla</span></code></a></p>
<p>Model for 3D Bragg ptycho data, where a set of rocking angles are
measured for each scanning position. The result is pods carrying
3D diffraction patterns and 3D Views into a 3D object.</p>
<p>Inherits from Vanilla because _create_pods and the object init
is identical.</p>
<p>Frames for each position are assembled according to the actual
xyz data, so it will not work if two acquisitions are done at the
same position.</p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.Bragg3dModel.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'illumination':</span> <span class="pre">{'aperture':</span> <span class="pre">{'central_stop':</span> <span class="pre">None,</span> <span class="pre">'diffuser':</span> <span class="pre">None,</span> <span class="pre">'edge':</span> <span class="pre">2.0,</span> <span class="pre">'form':</span> <span class="pre">'circ',</span> <span class="pre">'offset':</span> <span class="pre">0.0,</span> <span class="pre">'rotate':</span> <span class="pre">0.0,</span> <span class="pre">'size':</span> <span class="pre">None},</span> <span class="pre">'model':</span> <span class="pre">None,</span> <span class="pre">'photons':</span> <span class="pre">None,</span> <span class="pre">'propagation':</span> <span class="pre">{'antialiasing':</span> <span class="pre">1,</span> <span class="pre">'focussed':</span> <span class="pre">None,</span> <span class="pre">'parallel':</span> <span class="pre">None,</span> <span class="pre">'spot_size':</span> <span class="pre">None},</span> <span class="pre">'recon':</span> <span class="pre">{'label':</span> <span class="pre">None,</span> <span class="pre">'rfile':</span> <span class="pre">'\\*.ptyr'},</span> <span class="pre">'size':</span> <span class="pre">None},</span> <span class="pre">'name':</span> <span class="pre">'Bragg3dModel',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'sample':</span> <span class="pre">{'fill':</span> <span class="pre">1},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.Bragg3dModel.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.Full">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">Full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.Full" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager._Full</span></code>, <a class="reference internal" href="#ptypy.core.manager.ScanModel" title="ptypy.core.manager.ScanModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.ScanModel</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.Full.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'coherence':</span> <span class="pre">{'energies':</span> <span class="pre">[1.0],</span> <span class="pre">'num_object_modes':</span> <span class="pre">1,</span> <span class="pre">'num_probe_modes':</span> <span class="pre">1,</span> <span class="pre">'object_dispersion':</span> <span class="pre">None,</span> <span class="pre">'probe_dispersion':</span> <span class="pre">None,</span> <span class="pre">'spectrum':</span> <span class="pre">[1.0]},</span> <span class="pre">'illumination':</span> <span class="pre">{'aperture':</span> <span class="pre">{'central_stop':</span> <span class="pre">None,</span> <span class="pre">'diffuser':</span> <span class="pre">None,</span> <span class="pre">'edge':</span> <span class="pre">2.0,</span> <span class="pre">'form':</span> <span class="pre">'circ',</span> <span class="pre">'offset':</span> <span class="pre">0.0,</span> <span class="pre">'rotate':</span> <span class="pre">0.0,</span> <span class="pre">'size':</span> <span class="pre">None},</span> <span class="pre">'diversity':</span> <span class="pre">{'noise':</span> <span class="pre">(0.5,</span> <span class="pre">1.0),</span> <span class="pre">'power':</span> <span class="pre">0.1,</span> <span class="pre">'shift':</span> <span class="pre">None},</span> <span class="pre">'model':</span> <span class="pre">None,</span> <span class="pre">'photons':</span> <span class="pre">None,</span> <span class="pre">'propagation':</span> <span class="pre">{'antialiasing':</span> <span class="pre">1,</span> <span class="pre">'focussed':</span> <span class="pre">None,</span> <span class="pre">'parallel':</span> <span class="pre">None,</span> <span class="pre">'spot_size':</span> <span class="pre">None},</span> <span class="pre">'recon':</span> <span class="pre">{'label':</span> <span class="pre">None,</span> <span class="pre">'rfile':</span> <span class="pre">'\\*.ptyr'}},</span> <span class="pre">'name':</span> <span class="pre">'Full',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'resolution':</span> <span class="pre">None,</span> <span class="pre">'sample':</span> <span class="pre">{'diversity':</span> <span class="pre">{'noise':</span> <span class="pre">None,</span> <span class="pre">'power':</span> <span class="pre">0.1,</span> <span class="pre">'shift':</span> <span class="pre">None},</span> <span class="pre">'fill':</span> <span class="pre">1,</span> <span class="pre">'model':</span> <span class="pre">None,</span> <span class="pre">'process':</span> <span class="pre">{'density':</span> <span class="pre">1,</span> <span class="pre">'formula':</span> <span class="pre">None,</span> <span class="pre">'offset':</span> <span class="pre">(0,</span> <span class="pre">0),</span> <span class="pre">'ref_index':</span> <span class="pre">(0.5,</span> <span class="pre">0.0),</span> <span class="pre">'smoothing':</span> <span class="pre">2,</span> <span class="pre">'thickness':</span> <span class="pre">1e-06,</span> <span class="pre">'zoom':</span> <span class="pre">None},</span> <span class="pre">'recon':</span> <span class="pre">{'rfile':</span> <span class="pre">'\\*.ptyr'},</span> <span class="pre">'stxm':</span> <span class="pre">{'label':</span> <span class="pre">None}},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.Full.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.ModelManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">ModelManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.ModelManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Thin wrapper class which now just interfaces Ptycho with ScanModel.
This should probably all be done directly in Ptycho.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ptycho</strong> (<a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho"><em>Ptycho</em></a>) – The parent Ptycho object</p></li>
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – The .scans tree of the <a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Ptycho</span></code></a> parameters.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.manager.ModelManager.data_available">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_available</span></span><a class="headerlink" href="#ptypy.core.manager.ModelManager.data_available" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.manager.ModelManager.new_data">
<span class="sig-name descname"><span class="pre">new_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.ModelManager.new_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all new diffraction patterns and create all views and pods
accordingly.s</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.OPRModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">OPRModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.OPRModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager._OPRModel</span></code>, <a class="reference internal" href="#ptypy.core.manager.Full" title="ptypy.core.manager.Full"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.Full</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.OPRModel.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'coherence':</span> <span class="pre">{'energies':</span> <span class="pre">[1.0],</span> <span class="pre">'num_object_modes':</span> <span class="pre">1,</span> <span class="pre">'num_probe_modes':</span> <span class="pre">1,</span> <span class="pre">'object_dispersion':</span> <span class="pre">None,</span> <span class="pre">'probe_dispersion':</span> <span class="pre">None,</span> <span class="pre">'spectrum':</span> <span class="pre">[1.0]},</span> <span class="pre">'illumination':</span> <span class="pre">{},</span> <span class="pre">'name':</span> <span class="pre">'Full',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'resolution':</span> <span class="pre">None,</span> <span class="pre">'sample':</span> <span class="pre">{},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.OPRModel.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.ScanModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">ScanModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.ScanModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for models. Override at least these methods:
_create_pods(self)
_initialize_geo(self, common)
_initialize_probe(self, probe_ids)
_initialize_object(self, object_ids)</p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.ScanModel.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'illumination':</span> <span class="pre">{},</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'sample':</span> <span class="pre">{},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.ScanModel.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.manager.ScanModel.makePtyScan">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">makePtyScan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.ScanModel.makePtyScan" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory for PtyScan object. Return an instance of the appropriate PtyScan
subclass based on the input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameters according to <code class="xref py py-data docutils literal notranslate"><span class="pre">scan.data</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.manager.ScanModel.new_data">
<span class="sig-name descname"><span class="pre">new_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.ScanModel.new_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Feed data from ptyscan object.
:return: None if no data is available, True otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.manager.Vanilla">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.manager.</span></span><span class="sig-name descname"><span class="pre">Vanilla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptycho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.manager.Vanilla" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager._Vanilla</span></code>, <a class="reference internal" href="#ptypy.core.manager.ScanModel" title="ptypy.core.manager.ScanModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.manager.ScanModel</span></code></a></p>
<p>Create scan model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameter tree.</p></li>
<li><p><strong>ptycho</strong> (<em>Ptycho instance</em>) – Ptycho instance to which this scan belongs</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Unique label</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.manager.Vanilla.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'illumination':</span> <span class="pre">{'size':</span> <span class="pre">None},</span> <span class="pre">'name':</span> <span class="pre">'Vanilla',</span> <span class="pre">'propagation':</span> <span class="pre">'farfield',</span> <span class="pre">'resample':</span> <span class="pre">1,</span> <span class="pre">'sample':</span> <span class="pre">{'fill':</span> <span class="pre">1},</span> <span class="pre">'tags':</span> <span class="pre">['dummy']}</span></em><a class="headerlink" href="#ptypy.core.manager.Vanilla.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ptypy.core.paths">
<span id="ptypy-core-paths-module"></span><h2>ptypy.core.paths module<a class="headerlink" href="#module-ptypy.core.paths" title="Permalink to this headline">¶</a></h2>
<p>Path manager.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py data">
<dt class="sig sig-object py" id="ptypy.core.paths.DEFAULT">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.paths.</span></span><span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'autoplot':</span> <span class="pre">'plots/%(run)s/%(run)s_%(engine)s_%(iteration)04d.png',</span> <span class="pre">'autosave':</span> <span class="pre">'dumps/%(run)s/%(run)s_%(engine)s_%(iteration)04d.ptyr',</span> <span class="pre">'home':</span> <span class="pre">'./',</span> <span class="pre">'recon':</span> <span class="pre">'recons/%(run)s/%(run)s_%(engine)s.ptyr'}</span></em><a class="headerlink" href="#ptypy.core.paths.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd><p>Default path parameters. See <code class="xref py py-data docutils literal notranslate"><span class="pre">io.paths</span></code>
and a short listing below</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.paths.</span></span><span class="sig-name descname"><span class="pre">Paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">io</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.paths.Paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Path managing class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>io</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a><em> or </em><em>dict</em>) – Parameter set to pick path info from. See <a class="reference internal" href="parameters.html#id0" title="io"><code class="xref py py-data docutils literal notranslate"><span class="pre">io</span></code></a></p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'autoplot':</span> <span class="pre">'plots/%(run)s/%(run)s_%(engine)s_%(iteration)04d.png',</span> <span class="pre">'autosave':</span> <span class="pre">'dumps/%(run)s/%(run)s_%(engine)s_%(iteration)04d.ptyr',</span> <span class="pre">'home':</span> <span class="pre">'./',</span> <span class="pre">'recon':</span> <span class="pre">'recons/%(run)s/%(run)s_%(engine)s.ptyr'}</span></em><a class="headerlink" href="#ptypy.core.paths.Paths.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths.auto_file">
<span class="sig-name descname"><span class="pre">auto_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.paths.Paths.auto_file" title="Permalink to this definition">¶</a></dt>
<dd><p>File path for autosave file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths.get_path">
<span class="sig-name descname"><span class="pre">get_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runtime</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.paths.Paths.get_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths.plot_file">
<span class="sig-name descname"><span class="pre">plot_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.paths.Paths.plot_file" title="Permalink to this definition">¶</a></dt>
<dd><p>File path for plot file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths.recon_file">
<span class="sig-name descname"><span class="pre">recon_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.paths.Paths.recon_file" title="Permalink to this definition">¶</a></dt>
<dd><p>File path for reconstruction file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.paths.Paths.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.paths.Paths.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine run name</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ptypy.core.ptycho">
<span id="ptypy-core-ptycho-module"></span><h2>ptypy.core.ptycho module<a class="headerlink" href="#module-ptypy.core.ptycho" title="Permalink to this headline">¶</a></h2>
<p>ptycho - definition of the upper-level class Ptycho.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ptypy.core.ptycho.</span></span><span class="sig-name descname"><span class="pre">Ptycho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ptypy.core.classes.Base" title="ptypy.core.classes.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">ptypy.core.classes.Base</span></code></a></p>
<p>Ptycho : A ptychographic data holder and reconstruction manager.</p>
<p>This is the highest level class. It organizes and contains the data,
manages the reconstruction engines, and interacts with the outside world.</p>
<p>If MPI is enabled, this class acts both as a manager (rank = 0) and
a worker (any rank), and most information exists on all processes.
In its original design, the only part that is divided between processes is the
diffraction data.</p>
<p>By default Ptycho is instantiated once per process, but it can also
be used as a managed container to load past runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>~Ptycho.CType</strong><strong>,</strong><strong>FType</strong> (<em>numpy.dtype</em>) – numpy dtype for arrays. <cite>FType</cite> is for data, i.e. real-valued
arrays, <cite>CType</cite> is for complex-valued arrays</p></li>
<li><p><strong>~Ptycho.interactor</strong> (<a class="reference internal" href="ptypy.io.html#ptypy.io.interaction.Server" title="ptypy.io.interaction.Server"><em>ptypy.io.interaction.Server</em></a>) – ZeroMQ interaction server for communication with e.g. plotting
clients</p></li>
<li><p><strong>~Ptycho.runtime</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Runtime information, e.g. errors, iteration etc.</p></li>
<li><p><strong>~Ptycho.model</strong> (<a class="reference internal" href="#ptypy.core.manager.ModelManager" title="ptypy.core.manager.ModelManager"><em>ModelManager</em></a>) – THE managing instance for <a class="reference internal" href="#ptypy.core.classes.POD" title="ptypy.core.classes.POD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">POD</span></code></a>, <a class="reference internal" href="#ptypy.core.classes.View" title="ptypy.core.classes.View"><code class="xref any py py-class docutils literal notranslate"><span class="pre">View</span></code></a> and
<a class="reference internal" href="#ptypy.core.geometry.Geo" title="ptypy.core.geometry.Geo"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Geo</span></code></a> instances</p></li>
<li><p><strong>~Ptycho.obj</strong><strong>,</strong><strong>~Ptycho.exit</strong><strong>,</strong><strong>~Ptycho.diff</strong><strong>,</strong><strong>~Ptycho.mask</strong> (<em>probe</em><em>,</em>) – Container instances for illuminations, samples, exit waves,
diffraction data and detector masks / weights</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>pars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Input parameters, subset of the
<a class="reference internal" href="parameters.html#parameters"><span class="std std-ref">ptypy parameter tree</span></a></p></li>
<li><p><strong>level</strong> (<em>int</em>) – <p>Determines how much is initialized.</p>
<ul>
<li><p>&lt;= 0 : empty ptypy structure</p></li>
<li><dl class="simple">
<dt>1<span class="classifier">reads parameters, configures interaction server,</span></dt><dd><p>see <a class="reference internal" href="#ptypy.core.ptycho.Ptycho.init_structures" title="ptypy.core.ptycho.Ptycho.init_structures"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_structures()</span></code></a></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>2<span class="classifier">also configures Containers, initializes ModelManager</span></dt><dd><p>see <a class="reference internal" href="#ptypy.core.ptycho.Ptycho.init_data" title="ptypy.core.ptycho.Ptycho.init_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_data()</span></code></a></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>3<span class="classifier">also initializes ZeroMQ-communication</span></dt><dd><p>see <a class="reference internal" href="#ptypy.core.ptycho.Ptycho.init_communication" title="ptypy.core.ptycho.Ptycho.init_communication"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_communication()</span></code></a></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>4<span class="classifier">also initializes reconstruction engines,</span></dt><dd><p>see <a class="reference internal" href="#ptypy.core.ptycho.Ptycho.init_engine" title="ptypy.core.ptycho.Ptycho.init_engine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_engine()</span></code></a></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>&gt;= 4<span class="classifier">also and starts reconstruction</span></dt><dd><p>see <a class="reference internal" href="#ptypy.core.ptycho.Ptycho.run" title="ptypy.core.ptycho.Ptycho.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a></p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.DEFAULT">
<span class="sig-name descname"><span class="pre">DEFAULT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'data_type':</span> <span class="pre">'single',</span> <span class="pre">'dry_run':</span> <span class="pre">False,</span> <span class="pre">'engines':</span> <span class="pre">{},</span> <span class="pre">'frames_per_block':</span> <span class="pre">100000,</span> <span class="pre">'io':</span> <span class="pre">{'autoplot':</span> <span class="pre">{'active':</span> <span class="pre">True,</span> <span class="pre">'dump':</span> <span class="pre">False,</span> <span class="pre">'imfile':</span> <span class="pre">'plots/%(run)s/%(run)s_%(engine)s_%(iterations)04d.png',</span> <span class="pre">'interval':</span> <span class="pre">1,</span> <span class="pre">'layout':</span> <span class="pre">'default',</span> <span class="pre">'make_movie':</span> <span class="pre">False,</span> <span class="pre">'threaded':</span> <span class="pre">True},</span> <span class="pre">'autosave':</span> <span class="pre">{'active':</span> <span class="pre">True,</span> <span class="pre">'interval':</span> <span class="pre">10,</span> <span class="pre">'rfile':</span> <span class="pre">'dumps/%(run)s/%(run)s_%(engine)s_%(iterations)04d.ptyr'},</span> <span class="pre">'benchmark':</span> <span class="pre">None,</span> <span class="pre">'home':</span> <span class="pre">'./',</span> <span class="pre">'interaction':</span> <span class="pre">{'active':</span> <span class="pre">True,</span> <span class="pre">'client':</span> <span class="pre">{'address':</span> <span class="pre">'tcp://127.0.0.1',</span> <span class="pre">'connection_timeout':</span> <span class="pre">3600000.0,</span> <span class="pre">'pinginterval':</span> <span class="pre">1,</span> <span class="pre">'poll_timeout':</span> <span class="pre">100.0,</span> <span class="pre">'port':</span> <span class="pre">5560},</span> <span class="pre">'server':</span> <span class="pre">{'active':</span> <span class="pre">True,</span> <span class="pre">'address':</span> <span class="pre">'tcp://127.0.0.1',</span> <span class="pre">'connections':</span> <span class="pre">10,</span> <span class="pre">'pinginterval':</span> <span class="pre">2,</span> <span class="pre">'pingtimeout':</span> <span class="pre">10,</span> <span class="pre">'poll_timeout':</span> <span class="pre">10.0,</span> <span class="pre">'port':</span> <span class="pre">5560}},</span> <span class="pre">'rfile':</span> <span class="pre">'recons/%(run)s/%(run)s_%(engine)s_%(iterations)04d.ptyr',</span> <span class="pre">'rformat':</span> <span class="pre">'minimal'},</span> <span class="pre">'ipython_kernel':</span> <span class="pre">False,</span> <span class="pre">'run':</span> <span class="pre">None,</span> <span class="pre">'scans':</span> <span class="pre">{},</span> <span class="pre">'verbose_level':</span> <span class="pre">'ERROR'}</span></em><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.DEFAULT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.ID">
<span class="sig-name descname"><span class="pre">ID</span></span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.ID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.containers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">containers</span></span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.containers" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict of all <a class="reference internal" href="#ptypy.core.classes.Container" title="ptypy.core.classes.Container"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Container</span></code></a> instances in the pool of self</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleanup</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.init_communication">
<span class="sig-name descname"><span class="pre">init_communication</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.init_communication" title="Permalink to this definition">¶</a></dt>
<dd><p>Called on __init__ if <code class="docutils literal notranslate"><span class="pre">level</span> <span class="pre">&gt;=</span> <span class="pre">3</span></code>.</p>
<p>Initializes ZeroMQ communication on the master node and
spawns an optional plotting client.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.init_data">
<span class="sig-name descname"><span class="pre">init_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.init_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Called on __init__ if <code class="docutils literal notranslate"><span class="pre">level</span> <span class="pre">&gt;=</span> <span class="pre">2</span></code>.</p>
<p>Call <code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelManager.new_data()</span></code>
Prints statistics on the ptypy structure if <code class="docutils literal notranslate"><span class="pre">print_stats=True</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.init_engine">
<span class="sig-name descname"><span class="pre">init_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.init_engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Called on __init__ if <code class="docutils literal notranslate"><span class="pre">level</span> <span class="pre">&gt;=</span> <span class="pre">4</span></code>.</p>
<p>Initializes engine with label <cite>label</cite> from parameters and lists
it internally in <code class="docutils literal notranslate"><span class="pre">self.engines</span></code> which is an ordered dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – Label of engine which is to be created from parameter set of
the same label in input parameter tree. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an engine
is created for each available parameter set in input parameter
tree sorted by label.</p></li>
<li><p><strong>epars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a><em> or </em><em>dict</em>) – Set of engine parameters. The created engine is listed as
<em>auto00</em>, <em>auto01</em> , etc in <code class="docutils literal notranslate"><span class="pre">self.engines</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.init_structures">
<span class="sig-name descname"><span class="pre">init_structures</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.init_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Called on __init__ if <code class="docutils literal notranslate"><span class="pre">level</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code>.</p>
<p>Prepare everything for reconstruction. Creates attributes
<code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code> and the containers <code class="xref py py-attr docutils literal notranslate"><span class="pre">probe</span></code> for
illumination, <code class="xref py py-attr docutils literal notranslate"><span class="pre">obj</span></code> for the samples, <code class="xref py py-attr docutils literal notranslate"><span class="pre">exit</span></code> for
the exit waves, <code class="xref py py-attr docutils literal notranslate"><span class="pre">diff</span></code> for diffraction data and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Ptycho.mask</span></code> for detectors masks</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.load_run">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.load_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a previous run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>runfile</strong> (<em>str</em>) – file dump of Ptycho class</p></li>
<li><p><strong>load_data</strong> (<em>bool</em>) – If <cite>True</cite> also load data (thus regenerating pods &amp; views
for ‘minimal’ dump</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>P</strong> – Ptycho instance with <code class="docutils literal notranslate"><span class="pre">level</span> <span class="pre">==</span> <span class="pre">2</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#ptypy.core.ptycho.Ptycho" title="ptypy.core.ptycho.Ptycho">Ptycho</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.numID">
<span class="sig-name descname"><span class="pre">numID</span></span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.numID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.owner">
<span class="sig-name descname"><span class="pre">owner</span></span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.plot_overview">
<span class="sig-name descname"><span class="pre">plot_overview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fignum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.plot_overview" title="Permalink to this definition">¶</a></dt>
<dd><p>plots whole the first four layers of every storage in probe, object
% diff</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.pods">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pods</span></span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.pods" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict of all <a class="reference internal" href="#ptypy.core.classes.POD" title="ptypy.core.classes.POD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">POD</span></code></a> instances in the pool of self</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.print_stats">
<span class="sig-name descname"><span class="pre">print_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'summary'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.print_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the memory usage and other info of ptycho instance</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Called on __init__ if <code class="docutils literal notranslate"><span class="pre">level</span> <span class="pre">&gt;=</span> <span class="pre">5</span></code>.</p>
<p>Start the reconstruction with at least one engine.
As a consequence, <code class="docutils literal notranslate"><span class="pre">self.runtime</span></code> will be filled with content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – Engine label of engine to run. If <code class="docutils literal notranslate"><span class="pre">None</span></code> all available
engines are run in the order they were stored in
<code class="docutils literal notranslate"><span class="pre">self.engines</span></code>. If the engine is not yet created,
<a class="reference internal" href="#ptypy.core.ptycho.Ptycho.init_engine" title="ptypy.core.ptycho.Ptycho.init_engine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_engine()</span></code></a> is called for that label.</p></li>
<li><p><strong>epars</strong> (<em>dict</em><em> or </em><a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a><em>, </em><em>optional</em>) – Engine parameter set. An engine is created from this set,
using <a class="reference internal" href="#ptypy.core.ptycho.Ptycho.init_engine" title="ptypy.core.ptycho.Ptycho.init_engine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_engine()</span></code></a> and run immediately afterwards.
For parameters see <a class="reference internal" href="parameters.html#id3" title="engine"><code class="xref py py-data docutils literal notranslate"><span class="pre">engine</span></code></a></p></li>
<li><p><strong>engine</strong> (<a class="reference internal" href="ptypy.engines.html#ptypy.engines.base.BaseEngine" title="ptypy.engines.base.BaseEngine"><em>BaseEngine</em></a><em>, </em><em>optional</em>) – An engine instance that should be a subclass of
<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEngine</span></code> or have the same methods.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ptypy.core.ptycho.Ptycho.save_run">
<span class="sig-name descname"><span class="pre">save_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alt_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minimal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.ptycho.Ptycho.save_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Save run to file.</p>
<p>As for now, diffraction / mask data is not stored</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alt_file</strong> (<em>str</em>) – Alternative filepath, will override io.save_file</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – <p>Type of saving, one of:</p>
<blockquote>
<div><ul>
<li><p><em>’minimal’</em>, only initial parameters, probe and object
storages, positions and runtime information is saved.</p></li>
<li><p><em>’full_flat’</em>, (almost) complete environment</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-ptypy.core.sample">
<span id="ptypy-core-sample-module"></span><h2>ptypy.core.sample module<a class="headerlink" href="#module-ptypy.core.sample" title="Permalink to this headline">¶</a></h2>
<p>This module generates a sample.</p>
<p>&#64;author: Bjoern Enders</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.sample.init_storage">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.sample.</span></span><span class="sig-name descname"><span class="pre">init_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">storage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.sample.init_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a storage as sample transmission.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage</strong> (<a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><em>Storage</em></a>) – The object <a class="reference internal" href="#ptypy.core.classes.Storage" title="ptypy.core.classes.Storage"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Storage</span></code></a> to initialize</p></li>
<li><p><strong>sample_pars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Parameter structure that defines how the sample is created.
<em>FIXME</em> Link to parameters</p></li>
<li><p><strong>energy</strong> (<em>float</em><em>, </em><em>optional</em>) – Energy associated in the experiment for this sample object.
If None, the ptypy structure is searched for the appropriate
<code class="xref py py-class docutils literal notranslate"><span class="pre">Geo</span></code> instance:  <code class="docutils literal notranslate"><span class="pre">storage.views[0].pod.geometry.energy</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.sample.simulate">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.sample.</span></span><span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.sample.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates a sample object into model numpy array <cite>A</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ndarray</em>) – Numpy array as buffer. Must be at least two-dimensional</p></li>
<li><p><strong>pars</strong> (<a class="reference internal" href="ptypy.utils.html#ptypy.utils.parameters.Param" title="ptypy.utils.parameters.Param"><em>Param</em></a>) – Simulation parameters. <em>FIXME</em> link to paramaters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ptypy.core.save_load">
<span id="ptypy-core-save-load-module"></span><h2>ptypy.core.save_load module<a class="headerlink" href="#module-ptypy.core.save_load" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.save_load.from_h5">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.save_load.</span></span><span class="sig-name descname"><span class="pre">from_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.save_load.from_h5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.save_load.link">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.save_load.</span></span><span class="sig-name descname"><span class="pre">link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_objects_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_input_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.save_load.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse operation to unlink.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.save_load.to_h5">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.save_load.</span></span><span class="sig-name descname"><span class="pre">to_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.save_load.to_h5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.save_load.unlink">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.save_load.</span></span><span class="sig-name descname"><span class="pre">unlink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.save_load.unlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks into all references of obj. Places references in a pool with
string labels resembling their python ID plus an object dependent prefix.
Reduces all objects and dicts to dictionaries.
Reduces all tuples to list.
All references are replaced by the labels in the pool.</p>
<p>Original references in ‘obj’ are preserved</p>
</dd></dl>

</section>
<section id="module-ptypy.core.xy">
<span id="ptypy-core-xy-module"></span><h2>ptypy.core.xy module<a class="headerlink" href="#module-ptypy.core.xy" title="Permalink to this headline">¶</a></h2>
<p>This module generates the scan patterns.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.xy.from_pars">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.xy.</span></span><span class="sig-name descname"><span class="pre">from_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xypars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.xy.from_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates position array from parameter tree <cite>pars</cite>. See <code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xypars</strong> – TreeDict
Input parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray pos
A numpy.ndarray of shape <code class="docutils literal notranslate"><span class="pre">(N,2)</span></code> for <em>N</em> positions</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.xy.raster_scan">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.xy.</span></span><span class="sig-name descname"><span class="pre">raster_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.xy.raster_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a raster scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ny</strong> (<em>int</em>) – Number of steps in <em>y</em> (vertical) and <em>x</em> (horizontal) direction
<em>x</em> is the fast axis</p></li>
<li><p><strong>nx</strong> (<em>int</em>) – Number of steps in <em>y</em> (vertical) and <em>x</em> (horizontal) direction
<em>x</em> is the fast axis</p></li>
<li><p><strong>dy</strong> (<em>float</em>) – Step size (grid spacing) in <em>y</em> and <em>x</em></p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Step size (grid spacing) in <em>y</em> and <em>x</em></p></li>
<li><p><strong>ang</strong> (<em>float</em>) – Rotation angle of the raster grid (counterclockwise, in degrees)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pos</strong> – A (N,2)-array of positions. It is <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">(nx+1)*(nx+1)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ptypy.core</span> <span class="kn">import</span> <span class="n">xy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">raster_scan</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.xy.round_scan">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.xy.</span></span><span class="sig-name descname"><span class="pre">round_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bullseye</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.xy.round_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a round scan</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> (<em>int</em>) – Number of radial steps from center, <code class="docutils literal notranslate"><span class="pre">nr</span> <span class="pre">+</span> <span class="pre">1</span></code> shells will be made</p></li>
<li><p><strong>dr</strong> (<em>float</em>) – Step size (shell spacing)</p></li>
<li><p><strong>nth</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in first shell</p></li>
<li><p><strong>bullseye</strong> (<em>bool</em>) – If set false, point of origin will be ignored</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pos</strong> – A (N,2)-array of positions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ptypy.core</span> <span class="kn">import</span> <span class="n">xy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">round_scan</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ptypy.core.xy.spiral_scan">
<span class="sig-prename descclassname"><span class="pre">ptypy.core.xy.</span></span><span class="sig-name descname"><span class="pre">spiral_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ptypy.core.xy.spiral_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a spiral scan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – Number of radial steps from center, <code class="docutils literal notranslate"><span class="pre">nr</span> <span class="pre">+</span> <span class="pre">1</span></code> shells will be made</p></li>
<li><p><strong>dr</strong> (<em>float</em>) – Step size (shell spacing)</p></li>
<li><p><strong>nth</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in first shell</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pos</strong> – A (N,2)-array of positions. It is</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ptypy.core</span> <span class="kn">import</span> <span class="n">xy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">spiral_scan</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;o-&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-ptypy.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ptypy.core" title="Permalink to this headline">¶</a></h2>
<p>Core functionalities of the package.</p>
<p>This file is part of the PTYPY package.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>Copyright 2014 by the PTYPY team, see AUTHORS.</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GPLv2, see LICENSE for details.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../content.html">
              <img class="logo" src="../_static/logo_100px.png" alt="Logo"/>
            </a></p>
<h3><a href="../content.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started with Ptypy</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept.html">Concepts and Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_management.html">Data management</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Parameter tree structure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ptypy.html">ptypy package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ptypy.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">ptypy.core package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.engines.html">ptypy.engines package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.experiment.html">ptypy.experiment package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.io.html">ptypy.io package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.resources.html">ptypy.resources package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.simulations.html">ptypy.simulations package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.utils.html">ptypy.utils package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ptypy.debug.html">ptypy.debug package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ptypy.html#module-ptypy">Module contents</a></li>
</ul>
</li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="ptypy.html"
                          title="previous chapter">ptypy package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="ptypy.engines.html"
                          title="next chapter">ptypy.engines package</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/rst/ptypy.core.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ptypy.engines.html" title="ptypy.engines package"
             >next</a> |</li>
        <li class="right" >
          <a href="ptypy.html" title="ptypy package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../content.html">ptypy 0.5.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ptypy.html" >ptypy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ptypy.core package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Pierre Thibault, Bjoern Enders and others.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>